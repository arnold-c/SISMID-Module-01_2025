<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Callum Arnold">
<title>SISMID Module 2 Materials (2023) - Just Enough R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./project-management.html" rel="next">
<link href="./just-enough-rstudio.html" rel="prev">
<link href="././images/sismid2023-logo-green.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./exercise-requirements.html">Pre-Requisites</a></li><li class="breadcrumb-item"><a href="./just-enough-r.html">Just Enough R</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="././images/sismid2023-logo-green.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SISMID Module 2 Materials (2023)</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/arnold-c/SISMID-Module-02_2023" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Welcome</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Pre-Requisites</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-requirements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise Requirements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./install-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Install and Setup R &amp; RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./just-enough-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Just Enough RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./just-enough-r.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Just Enough R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organizing A Project</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Day 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L01_intro-to-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L02_sir-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basics of SIR Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-session-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R Session 01</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L03_hit-and-vaccinations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Herd Immunity &amp; Vaccination</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Day 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L04_heterogeneity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Heterogeneity in Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L05_age-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Age Structured Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-session-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R Session 02</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L06_parameter-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-session-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R Session 03</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Day 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L07_models-and-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Confronting Models with Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L08_stochastic-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Stochastic Models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>References</strong></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Page Items</h2>
   
  <ul>
<li><a href="#objects-types-introduction" id="toc-objects-types-introduction" class="nav-link active" data-scroll-target="#objects-types-introduction">Objects &amp; types introduction</a></li>
  <li><a href="#element-types" id="toc-element-types" class="nav-link" data-scroll-target="#element-types">Element types</a></li>
  <li>
<a href="#object-types" id="toc-object-types" class="nav-link" data-scroll-target="#object-types">Object types</a>
  <ul class="collapse">
<li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li><a href="#lists" id="toc-lists" class="nav-link" data-scroll-target="#lists">Lists</a></li>
  <li><a href="#dataframes" id="toc-dataframes" class="nav-link" data-scroll-target="#dataframes">Dataframes</a></li>
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices">Matrices</a></li>
  </ul>
</li>
  <li>
<a href="#indexing-objects" id="toc-indexing-objects" class="nav-link" data-scroll-target="#indexing-objects">Indexing objects</a>
  <ul class="collapse">
<li><a href="#indexing-operators" id="toc-indexing-operators" class="nav-link" data-scroll-target="#indexing-operators">Indexing operators</a></li>
  <li><a href="#indexing-vectors" id="toc-indexing-vectors" class="nav-link" data-scroll-target="#indexing-vectors">Indexing vectors</a></li>
  <li><a href="#lists-and-dataframes" id="toc-lists-and-dataframes" class="nav-link" data-scroll-target="#lists-and-dataframes">Lists and Dataframes</a></li>
  </ul>
</li>
  <li>
<a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a>
  <ul class="collapse">
<li><a href="#finding-packages" id="toc-finding-packages" class="nav-link" data-scroll-target="#finding-packages">Finding packages</a></li>
  <li><a href="#installing-packages" id="toc-installing-packages" class="nav-link" data-scroll-target="#installing-packages">Installing packages</a></li>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages">Loading packages</a></li>
  </ul>
</li>
  <li>
<a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a>
  <ul class="collapse">
<li><a href="#anonymous-functions" id="toc-anonymous-functions" class="nav-link" data-scroll-target="#anonymous-functions">Anonymous functions</a></li>
  </ul>
</li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">Tidy data</a></li>
  <li>
<a href="#core-code-used" id="toc-core-code-used" class="nav-link" data-scroll-target="#core-code-used">Core code used</a>
  <ul class="collapse">
<li><a href="#tibble" id="toc-tibble" class="nav-link" data-scroll-target="#tibble"><code>tibble()</code></a></li>
  <li><a href="#dplyrfilter" id="toc-dplyrfilter" class="nav-link" data-scroll-target="#dplyrfilter"><code>dplyr::filter()</code></a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"><code>select()</code></a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate"><code>mutate()</code></a></li>
  <li><a href="#paste0" id="toc-paste0" class="nav-link" data-scroll-target="#paste0"><code>paste0()</code></a></li>
  <li><a href="#sec-glue" id="toc-sec-glue" class="nav-link" data-scroll-target="#sec-glue"><code>glue::glue()</code></a></li>
  <li><a href="#str_replace_all" id="toc-str_replace_all" class="nav-link" data-scroll-target="#str_replace_all"><code>str_replace_all()</code></a></li>
  <li><a href="#across" id="toc-across" class="nav-link" data-scroll-target="#across"><code>across()</code></a></li>
  <li><a href="#everything" id="toc-everything" class="nav-link" data-scroll-target="#everything"><code>everything()</code></a></li>
  <li><a href="#contains" id="toc-contains" class="nav-link" data-scroll-target="#contains"><code>contains()</code></a></li>
  <li><a href="#rename_with" id="toc-rename_with" class="nav-link" data-scroll-target="#rename_with"><code>rename_with()</code></a></li>
  <li><a href="#magrittr" id="toc-magrittr" class="nav-link" data-scroll-target="#magrittr"><code>magrittr::%&gt;%</code></a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><code>|&gt;</code></a></li>
  <li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by"><code>group_by()</code></a></li>
  <li><a href="#sec-pivot-functions" id="toc-sec-pivot-functions" class="nav-link" data-scroll-target="#sec-pivot-functions"><code>pivot_*()</code></a></li>
  <li><a href="#sec-map-functions" id="toc-sec-map-functions" class="nav-link" data-scroll-target="#sec-map-functions"><code>map_*()</code></a></li>
  <li><a href="#nest" id="toc-nest" class="nav-link" data-scroll-target="#nest"><code>nest()</code></a></li>
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot"><code>ggplot()</code></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><code>%*%</code></a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/arnold-c/SISMID-Module-02_2023/edit/main/just-enough-r.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Just Enough R</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://callumarnold.com">Callum Arnold</a> <a href="https://orcid.org/0000-0002-3245-6956" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Pennsylvania State University
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header><p>The purpose of this section is to get you up-to-speed with <code>R</code>. If you’re completely unfamiliar with <code>R</code> and RStudio, this should provide you with enough to get started and understand what’s going on in the code (and you can always refer back to this page if you understandably get a little lost), and if you have some experience, then it should provide a sufficient description of the packages and functions that we use in this workshop.</p>
<p>Now you have <code>R</code> set installed and you can access it using RStudio, it’s time to learn some of the core features of the language (see <a href="install-r.html#rstudio">below</a> for details about using RStudio).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’d strongly recommend you read <a href="https://rstudio-education.github.io/hopr">Hands-On Programming With R</a> by Garett Grolemund and <a href="https://r4ds.hadley.nz/">R for DataScience</a> by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund for a deeper understanding of the following concepts (and many more).</p>
</div>
</div>
<section id="objects-types-introduction" class="level2"><h2 class="anchored" data-anchor-id="objects-types-introduction">Objects &amp; types introduction</h2>
<p>An object is anything you can create in R using code, whether that is a table you import from a <strong>csv</strong> file (that will get converted to a <strong>dataframe</strong>), or a <strong>vector</strong> you create within a script. Each object you create has a <strong>type</strong>. We’ve already mentioned two (<strong>dataframes</strong> and <strong>vectors</strong>), but there are plenty more. But before we get into object types, let’s take a step back and look at types in general, thinking about individual elements and the fundamentals.</p>
</section><section id="element-types" class="level2"><h2 class="anchored" data-anchor-id="element-types">Element types</h2>
<p>Generally in programming, we have two broad types of numbers: <strong>floating point</strong> and <strong>integer</strong> numbers, i.e., numbers with decimals, and whole numbers, respectively. In <code>R</code>, we have these number types, but a <strong>floating point</strong> number is called a <strong>double</strong>. The <strong>floating point</strong> number is the default type <code>R</code> assigns to number: look at the types assigned when we leave off a decimal place vs.&nbsp;specify type integer by ending a number with an <code>L</code>.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-1_7fed27930183a101f2ded636ef2e8eff">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "double"</code></pre>
</div>
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "integer"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Technically type <strong>double</strong> is a subset of type <strong>numeric</strong>, so you will often see people convert numbers to floating points using <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>, rather than <code><a href="https://rdrr.io/r/base/double.html">as.double()</a></code>, but the different is semantics. You can confirm this using the command <code>typeof(as.numeric(10)) == typeof(as.double(10))semantics. You can confirm this using the command</code>typeof(as.numeric(10)) == typeof(as.double(10))`.</p>
</div>
</div>
</div>
<p>Integer types are not commonly used in <code>R</code>, but there are occasions when you will want to use them e.g., when you need whole numbers of people in a simulation you may want to use integers to enforce this. Integers are also slightly more precise (unless very big or small), so when exactness in whole number is required, you may want to use integers.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>R</code> has some idiosyncrasies when it comes to numbers. For the most part, <strong>doubles</strong> are produced, but occasionally an <strong>integer</strong> will be produced when you are expecting a <strong>double</strong>.</p>
<p>For example:</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-2_41796d08f8df336964873ea5e4d862ce">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Outside of numbers, we have <strong>characters</strong> (<strong>strings</strong>) and <strong>boolean</strong> types.</p>
<p>A <strong>boolean</strong> (also known as a <strong>logical</strong> in <code>R</code>) is a <code>TRUE/FALSE</code> statement. In <code>R</code>, as in many programming languages, <code>TRUE</code> is equal to a value of 1, and <code>FALSE</code> equals <code>0</code>. There are times when this comes in handy e.g.&nbsp;you need to calculate the number of people that responded to a question, and their responses is coded as <code>TRUE/FALSE</code>, you can just sum the <strong>vector</strong> of responses (more on <strong>vectors</strong> shortly).</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-3_a260ce38415c7548dfd3be1a2c27e5f4">
<div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="cn">TRUE</span> <span class="op">==</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="cn">FALSE</span> <span class="op">==</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] TRUE</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Question">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can you figure out what value will be returned for the command <code>(TRUE == 0) == FALSE</code>?</p>
</div>
</div>
<p>A <strong>character</strong> is anything in quotation marks. This would typically by letter, but is occasionally a number, or other symbol. Other languages make a distinction between <strong>characters</strong> and <strong>strings</strong>, but not <code>R</code>.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-4_be4bf4338971c35e59507993d709fdba">
<div class="sourceCode" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="st">"1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "character"</code></pre>
</div>
</div>
<p>It is important to note that characters are not <strong>parsed</strong> i.e., they are not interpreted by <code>R</code> as anything other than a <strong>character</strong>. This means that despite <code>"1"</code> looking like the number <code>1</code>, it behaves like a <strong>character</strong> in <code>R</code>, not a <strong>double</strong>, so we can’t do addition etc. with it.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-5_2db7db9777b11706eb78b768690eaec6">
<div class="sourceCode" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"1"</span> <span class="op">+</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre data-code-line-numbers=""><code>Error in "1" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</section><section id="object-types" class="level2"><h2 class="anchored" data-anchor-id="object-types">Object types</h2>
<section id="vectors" class="level3"><h3 class="anchored" data-anchor-id="vectors">Vectors</h3>
<p>As mentioned, anything you can create in <code>R</code> is an object. For example, we can create an character object with the assignment operator (<code>&lt;-</code>).</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-6_e4f4cbf1237f4932b0c02edc7b0f988b">
<div class="sourceCode" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_char_obj</span> <span class="op">&lt;-</span> <span class="st">"a"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In other languages, <code>=</code> is used for assignment. In <code>R</code>, this is generally avoided to distinguish between creating objects (assignment), and specifying argument values (see the <a href="#functions">section on functions</a>). However, despite what some purists may say, it really doesn’t matter which one you use, from a practical standpoint.</p>
</div>
</div>
</div>
<p>You will note that when we created our object, it did not return a value (unlike the previous examples, a value was not printed). To retrieve the value of the object (in this case, just print it), we just type out the object name.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-7_ea273eb546b35969ea6a505cbebe991a">
<div class="sourceCode" id="cb24" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_char_obj</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "a"</code></pre>
</div>
</div>
<p>In this case, we just create an object with only one element. We can check this using the <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> function.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-8_634df407247be4774097dbd6cdcc9abd">
<div class="sourceCode" id="cb26" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">my_char_obj</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1</code></pre>
</div>
</div>
<p>We could also create an <strong>atomic vector</strong> (commonly just called a <strong>vector</strong>, which we’ll use from here-on in). In fact, <code>my_char_obj</code> is actually an <strong>vector</strong>, i.e., it is a vector of length 1, as we’ve just seen. Generally, a <strong>vector</strong> is an object that contains multiple elements that each have the same type.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-9_323d40e1fdfecafb900a6b6c8a78b727">
<div class="sourceCode" id="cb28" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_char_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we’ll see in the example below, we can give each element in a <strong>vector</strong> a name, and to highlight that vectors must contain elements of the same type, watch what happens here.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-10_80d8254a841b36eb3738bfa2c9b741f2">
<div class="sourceCode" id="cb29" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_char_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"a"</span>, b <span class="op">=</span> <span class="st">"b"</span>, c <span class="op">=</span> <span class="st">"c"</span>, d <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">my_named_char_vec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "a" "b" "c" "d"</code></pre>
</div>
<div class="sourceCode" id="cb31" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_char_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>  a   b   c   d 
"a" "b" "c" "1" </code></pre>
</div>
</div>
<p>Because <code>R</code> saw the majority of the first elements in the <strong>vector</strong> were of type <strong>character</strong> it <strong>coerced</strong> the number to a <strong>character</strong>. This is super important to be aware of, as it can cause errors, particularly when coercion goes in the other direction i.e.&nbsp;trying to create a <strong>numeric vector</strong>.</p>
<section id="factors" class="level4"><h4 class="anchored" data-anchor-id="factors">Factors</h4>
<p>All the <strong>vector</strong> types we’ve mentioned so far map nicely to their corresponding <strong>element</strong> types. But there is an extension of the <strong>character</strong> vector used frequently: the <strong>factor</strong> (and, correspondingly, the <strong>ordered</strong> vector).</p>
<p>A <strong>factor</strong> is a <strong>vector</strong> where there are distinct groups that exist within a <strong>vector</strong> i.e., they are <em>nominal categorical data</em>. For example, we often include gender as a covariate in epidemiological analysis. There is no intrinsic order, but we would want to account for the groups in the analysis.</p>
<p>An <strong>ordered vector</strong> is when there <em>is</em> an intrinsic order to the grouping i.e., we have <em>ordinal categorical data</em>. If, for example, we were interested in how the frequency of cigarette smoking is related to an outcome, and we wanted to use <em>binned</em> groups, rather than treating it as a continuous value, we would want to create an <strong>ordered vector</strong> as the ordering of the different groupings is important.</p>
<p>Let’s use the <code>mtcars</code> dataset (that comes installed with <code>R</code>), and turn the number of cylinders (<code>cyl</code>) into an <strong>ordered vector</strong>, as there are discrete numbers of cylinders a car engine can have, <em>and</em> the ordering matters. Don’t worry about what <code>$</code> is doing; we’ll come to that <a href="#indexing-objects">later</a></p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-11_184804b7a4ce842b1e338926329331ec">
<div class="sourceCode" id="cb33" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_mtcars</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</code></pre>
</div>
<div class="sourceCode" id="cb35" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span>
<span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4
Levels: 4 &lt; 6 &lt; 8</code></pre>
</div>
</div>
<p>If we wanted to directly specify the ordering of the groups, we can do this using the <code>levels</code> argument i.e.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-12_0f5fae6d8a790f53dcc96cbc7cfb6d29">
<div class="sourceCode" id="cb37" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_mtcars</span><span class="op">$</span><span class="va">cyl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4
Levels: 8 &lt; 6 &lt; 4</code></pre>
</div>
</div>
<p>To create a <strong>factor</strong>, just replace the <code><a href="https://rdrr.io/r/base/factor.html">ordered()</a></code> call with <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code></p>
</section></section><section id="lists" class="level3"><h3 class="anchored" data-anchor-id="lists">Lists</h3>
<p>There is another type of <strong>vector</strong>: the <strong>list</strong>. Most people do not refer to <strong>lists</strong> as type of <strong>vectors</strong>, so we will only refer to them as <strong>lists</strong>, and <strong>atomic vectors</strong> will just be referred to as <strong>vectors</strong>.</p>
<p>Unlike <strong>vectors</strong> there are no requirements about the form of <strong>lists</strong> i.e., each element of the <strong>list</strong> can be completely different. One element could store a <strong>vector</strong> of numbers, another a model object, another a <strong>dataframe</strong>, and another a <strong>list</strong> (i.e.&nbsp;a nested <strong>list</strong>).</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-13_e471ccd05bf90d039e55759ac6fce060">
<div class="sourceCode" id="cb39" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op">+</span> <span class="va">disp</span> <span class="op">+</span> <span class="va">hp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>column_1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, column_2 <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">my_named_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    my_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    my_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op">+</span> <span class="va">disp</span> <span class="op">+</span> <span class="va">hp</span>, data <span class="op">=</span> <span class="va">my_mtcars</span><span class="op">)</span>,</span>
<span>    my_dataframe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>column_1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, column_2 <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">my_list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
[1] 1 2 3 4 5

[[2]]

Call:  glm(formula = mpg ~ ordered(cyl) + disp + hp, data = mtcars)

Coefficients:
   (Intercept)  ordered(cyl).L  ordered(cyl).Q            disp              hp  
      28.98802        -1.71963         2.31169        -0.02604        -0.02114  

Degrees of Freedom: 31 Total (i.e. Null);  27 Residual
Null Deviance:      1126 
Residual Deviance: 225.1    AIC: 165.2

[[3]]
  column_1 column_2
1        1        6
2        2        7
3        3        8
4        4        9
5        5       10</code></pre>
</div>
<div class="sourceCode" id="cb41" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$my_vec
[1] 1 2 3 4 5

$my_model

Call:  glm(formula = mpg ~ ordered(cyl) + disp + hp, data = my_mtcars)

Coefficients:
   (Intercept)  ordered(cyl).L  ordered(cyl).Q            disp              hp  
      28.98802         1.71963         2.31169        -0.02604        -0.02114  

Degrees of Freedom: 31 Total (i.e. Null);  27 Residual
Null Deviance:      1126 
Residual Deviance: 225.1    AIC: 165.2

$my_dataframe
  column_1 column_2
1        1        6
2        2        7
3        3        8
4        4        9
5        5       10</code></pre>
</div>
</div>
<p>Similar to <strong>vectors</strong>, <strong>lists</strong> can be named, or unnamed, and also that we they display in slightly different ways: when unnamed, we get the notation <code>[[1]] ... [[3]]</code> to denote the different <strong>list</strong> elements, and with the <strong>named list</strong> we get <code>$my_vec ... $my_dataframe</code>. It is often useful to name them, though, as it gives you some useful options when it comes to indexing and extracting values later.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you’re wondering why we are creating our list elements with the <code>=</code> operator, that’s because we can think of this as an argument in the <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> function, where the argument name is the name we want the element to have, and the argument value is the element itself.</p>
</div>
</div>
</div>
</section><section id="dataframes" class="level3"><h3 class="anchored" data-anchor-id="dataframes">Dataframes</h3>
<p><strong>Dataframes</strong> are the last key object type to learn about. A <strong>dataframe</strong> is technically a special type of list. Effectively, it is a 2-D table where every column has to have elements of the same type (i.e., is a <strong>vector</strong>), but the columns can be different types to each other. The other important restriction is that all columns must be the same length, i.e.&nbsp;we have a rectangular <strong>dataframe</strong>.</p>
<p>As we’ve seen before, we can create a dataframe using this code, where <code>1:5</code> is shorthand for a vector that contains the sequence of numbers from 1 to 5, inclusive (i.e., <code>c(1, 2, 3, 4, 5)</code>). We could also write this sequence as <code>seq(1, 5, by = 1)</code>, allowing us more control over the steps in the sequence.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-14_f4e7ab79b029bea049ecd7dd5a9a5409">
<div class="sourceCode" id="cb43" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    column_int <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>    column_dbl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    column_3 <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Like with every other object type, we can just type in the <strong>dataframe’s</strong> name to return it’s value, but this tim, let’ explore the <em>structure</em> of the <strong>dataframe</strong> using the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function. This function can be used on any of the objects we’ve seen so far, and is particularly helpful when exploring <strong>lists</strong>. One nice feature of <strong>dataframes</strong> is that it will explicitly print the columns types.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-15_20f1ec8f6653ce108a4ff12e77ac5699">
<div class="sourceCode" id="cb44" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">my_dataframe</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>'data.frame':   5 obs. of  3 variables:
 $ column_int: int  1 2 3 4 5
 $ column_dbl: num  6 7 8 9 10
 $ column_3  : chr  "a" "b" "c" "d" ...</code></pre>
</div>
</div>
</section><section id="matrices" class="level3"><h3 class="anchored" data-anchor-id="matrices">Matrices</h3>
<p><strong>Matrices</strong> are crucial to many scientific fields, including epidemiology, as they are the basis of linear algebra. This course will use <strong>matrix</strong> multiplication extensively (notably <a href="./r-session-02.html">R Session 2</a>), so it is worth knowing how to create matrices.</p>
<p>Much like vectors, all elements in a <strong>matrix</strong> should be the same type (or they will be coerced if possible, resulting in <code>NA</code> if not). It is unusual to have a <strong>non-numeric matrix</strong> e.g., a <strong>character matrix</strong>, but it is possible. When we create our <strong>matrix</strong>, notice that it fills column-first, much like how we think of <strong>matrices</strong> in math (i.e., <code>i</code> then <code>j</code>).</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-16_e38bb6219c44346a471633a7d4c619f6">
<div class="sourceCode" id="cb46" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">my_matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     [,1] [,2] [,3] [,4]
[1,]    1    3    5    7
[2,]    2    4    6    8</code></pre>
</div>
</div>
</section></section><section id="indexing-objects" class="level2"><h2 class="anchored" data-anchor-id="indexing-objects">Indexing objects</h2>
<section id="indexing-operators" class="level3"><h3 class="anchored" data-anchor-id="indexing-operators">Indexing operators</h3>
<p>We’ve got our objects, but now we want to do stuff with them. Without getting into too much detail about <em>Object-Oriented Programming</em> (e.g., the <code>S3</code> class system in <code>R</code>), there are three mains ways of indexing in <code>R</code>:</p>
<ul>
<li>The single bracket <code>[]</code>
</li>
<li>The double bracket <code>[[]]</code>
</li>
<li>The dollar sign <code>$</code>
</li>
</ul>
<p>Which method we use depends on the type of object we have. Handily, <code>[]</code> will work for pretty much everything, and we typically only use use <code>[[]]</code> for <strong>lists</strong>.</p>
</section><section id="indexing-vectors" class="level3"><h3 class="anchored" data-anchor-id="indexing-vectors">Indexing vectors</h3>
<p>With both <code>[]</code> and <code>[[]]</code>, we can use the <em>indices</em> i.e., the numbered position of the specific values/elements we want to extract, but if we have named objects, we can pass the names to the <code>[]</code> in a <strong>vector</strong>.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-17_7a0d1e0ab6bdd4468f2d85908e525d68">
<div class="sourceCode" id="cb48" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract elements 1 through 3 inclusively</span></span>
<span><span class="va">my_char_vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode" id="cb50" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the same elements but using their names in a vector</span></span>
<span><span class="va">my_named_char_vec</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>  a   b   c 
"a" "b" "c" </code></pre>
</div>
</div>
<p>Notice that when we index the named <strong>vector</strong> we get <em>both</em> the name <em>and</em> the value returned. Many times this is OK, but if we only wanted the value, then you’d index with <code>[[]]</code>, but it is important to note that you can only pass <em>one</em> value to the brackets.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-18_fa86ce8df0ba9688c9a322db7ec64ac0">
<div class="sourceCode" id="cb52" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_char_vec</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre data-code-line-numbers=""><code>Error in my_named_char_vec[[c("a", "b")]]: attempt to select more than one element in vectorIndex</code></pre>
</div>
<div class="sourceCode" id="cb54" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_char_vec</span><span class="op">[[</span><span class="st">"a"</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "a"</code></pre>
</div>
</div>
<p>If you’re wondering why go through the hassle, it’s because values can change position in the list when we update inputs, such as <strong>csv</strong> datafiles, or needing to restructure code to make something else work. If we only index with the numeric indices, we run the risk of a silent error being returned i.e., a value is provided to us, but we don’t know that it’s referring to the wrong thing. Indexing with names mean that the element’s position in the <strong>vector</strong> doesn’t matter, and if it’s accidentally been removed when we updated code, and error will be explicitly thrown as it won’t be able to find the index.</p>
</section><section id="lists-and-dataframes" class="level3"><h3 class="anchored" data-anchor-id="lists-and-dataframes">Lists and Dataframes</h3>
<p>When it comes to indexing <strong>lists</strong> and <strong>dataframes</strong> (remember, <strong>dataframes</strong> are just special <strong>lists</strong>, so the same methods are available to us), it is more common to use <code>[[]]</code> and <code>$</code>, though there are obviously occasions when <code>[]</code> is useful. Let’s look at <code>my_named_list</code> first.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-19_4cb8f04dd72035ec1c952f15e889de9c">
<div class="sourceCode" id="cb56" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$my_vec
[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb58" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_list</span><span class="op">[</span><span class="st">"my_vec"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$my_vec
[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb60" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb62" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_list</span><span class="op">[[</span><span class="st">"my_vec"</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb64" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_named_list</span><span class="op">$</span><span class="va">my_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1 2 3 4 5</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the examples above, notice how both <code>[]</code> methods returned the name of the element as well as the values (as it did before with the named <strong>vector</strong>). This is important as it means we need to extract the values from what is returned before we can do any further indexing i.e., to get the value <code>3</code> from the <strong>list</strong> element <code>my_vec</code>.</p>
</div>
</div>
<p>We can do the same with the unnamed <strong>list</strong>, except the last two methods are not available as we do not have a name to use.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-20_f21f74bf7d07087b4aa3f3bc3bfd1c8e">
<div class="sourceCode" id="cb66" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb68" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1 2 3 4 5</code></pre>
</div>
</div>
<p>Because a <strong>dataframe</strong> is a type of list where the column headers are the element names, we can use <code>[[]]</code> and <code>$</code> as with the named list.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-21_3491ad3176712148ba70b78b7082071f">
<div class="sourceCode" id="cb70" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dataframe</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [5, 1]
column_int int 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb72" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dataframe</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb74" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dataframe</span><span class="op">[</span><span class="st">"column_int"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [5, 1]
column_int int 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode" id="cb76" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dataframe</span><span class="op">$</span><span class="va">column_int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1 2 3 4 5</code></pre>
</div>
</div>
<p>If we wanted to extract a particular value from a column, we can use the following methods.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-22_55ec8f25c7f5c1bb6b4e16532d103711">
<div class="sourceCode" id="cb78" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># indexes i then j, just like in math</span></span>
<span><span class="va">my_dataframe</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb80" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the second element from the first column</span></span>
<span><span class="va">my_dataframe</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb82" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the second element from column_int, using the i, j procedure as before</span></span>
<span><span class="va">my_dataframe</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"column_int"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 2</code></pre>
</div>
<div class="sourceCode" id="cb84" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract the second element from column_int</span></span>
<span><span class="va">my_dataframe</span><span class="op">$</span><span class="va">column_int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 2</code></pre>
</div>
</div>
</section></section><section id="packages" class="level2"><h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>Up until now, we’ve been getting to grips with the core concepts of objects, and indexing them. But when you’re writing code, you’ll want to do things that are relatively complicated to implement, such as solve a set of differential equations. Fortunately, for many areas of computing (and, indeed, epidemiology and statistics), many others have also struggled with the same issues and some have gone one to document their solutions in a way others can re-use them. This is the basis for <strong>packages</strong>. Someone has <em>packaged up</em> a set of functions for others to re-use.</p>
<p>We’ve mentioned the word <strong>function</strong> a number of time so far, and we haven’t defined it, but that’s <a href="#functions">coming soon</a>. For the moment, let’s just look at how we can find, install, and load <strong>packages</strong>.</p>
<section id="finding-packages" class="level3"><h3 class="anchored" data-anchor-id="finding-packages">Finding packages</h3>
<p>As <a href="./install-r.html#r">mentioned previously</a> CRAN is a place where many pieces of <code>R</code> code is documents and stored for others to download and use. Not only are the <code>R</code> programming language executables stored in CRAN, but so are user-defined <strong>functions</strong> that have been turned into <strong>packages</strong>.</p>
<p>To find packages, you can go to the CRAN website and search by name, but there are far too many for that to be worthwhile - just Google what you want to do and add “r” to the end of your search query, and you’ll likely find what you’re looking for. Once you’ve found a package you want to download, next you need to install it.</p>
</section><section id="installing-packages" class="level3"><h3 class="anchored" data-anchor-id="installing-packages">Installing packages</h3>
<p>Barring any super-niche packages, you should be able to use the following command(s):</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-23_28099d379e21efb6c60f422bf5669dcd">
<div class="sourceCode" id="cb86" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"package to download"</span><span class="op">)</span></span>
<span><span class="co"># Download multiple by passing a vector of package names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"package 1"</span>, <span class="st">"package 2"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If for some reason you get an error message saying the package isn’t available on CRAN, first, check for typos, and if you still get an error, you may need to download it directly from GitHub. Read <a href="https://pak.r-lib.org/dev/reference/get-started.html#install-a-package-from-github">here</a> for more information about using the <a href="https://pak.r-lib.org/">pak</a> package to download packages from other sources.</p>
</section><section id="loading-packages" class="level3"><h3 class="anchored" data-anchor-id="loading-packages">Loading packages</h3>
<p>Now you have your packages installed, you just need to load them to get any of their functionality. The easiest way is to place this code at the top of your script.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-24_0660e0d2cc7d119e240d37c4dc6a7dae">
<div class="sourceCode cell-code" id="cb87" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quotations are not required, but can be used</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(package to download)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a id="namespace-conflict"></a></p>
<p>Most of the time, this is fine, but occasionally you will run in to an issue where a function doesn’t work as expected. Sometimes this is because of what’s called a <em>namespace conflict</em> i.e., you have two functions with the same name loaded, and potentially you’re using the wrong verion.</p>
<p>For example, in base <code>R</code> (i.e, these functions come pre-installed when you set up <code>R</code>), there is a <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function from the <code>{stats}</code> package (as mentioned, we’ll denote this as <code><a href="https://rdrr.io/r/stats/filter.html">stats::filter()</a></code>). Throughout this workshop, you will see <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code> at the top of the pages to indicate the <a href="https://tidyverse.tidyverse.org">tidyverse</a> set of packages are being loaded (this is actually a package that installs a bunch of related and useful packages for us). In <a href="https://dplyr.tidyverse.org">dplyr</a> (one of the packages loaded by <a href="https://tidyverse.tidyverse.org">tidyverse</a>) there is also a function called <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>. Because <a href="https://dplyr.tidyverse.org">dplyr</a> was loaded after <code>{stats}</code> was loaded (because <code>{stats}</code> is automatically loaded when <code>R</code> is started), the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code> function will take precedence. If we wanted to specifically use the <code>{stats}</code> version, we could write this:</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-25_9d62a0bfc7969ec699e0616a7194e375">
<div class="sourceCode" id="cb88" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a cosine wave with random noise</span></span>
<span><span class="va">raw_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate 20 day moving average using stats::filter()</span></span>
<span><span class="va">smooth_timeseries</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">raw_timeseries</span>, filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, sides <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot raw data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">raw_timeseries</span>, col <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlay smoothed data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">smooth_timeseries</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="just-enough-r_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="functions" class="level2"><h2 class="anchored" data-anchor-id="functions">Functions</h2>
<p>As we’ve alluded to, <strong>functions</strong> are core to gaining <em>functionality</em> in <code>R</code>. We can always hand-write the code to complete a task, but if we have to repeat a task more than once, it can be tiresome to repeat the same code, particularly if it is a particularly complex task that requires many lines of code. This is where <strong>functions</strong> come in: they provide us with a mechanism to wrap up code into something that can be re-used. Not only does this reduce the amount of code we need to write, but by minimize code duplication, debugging becomes a lot easier as we only need to remember to make changes and correct one section of our codebase. Say, for example, you want to take a vector of numbers and calculate the cumulative sum e.g.;</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-26_26627b60a12d701a6f88407c8730170e">
<div class="sourceCode" id="cb89" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dbl_vec</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="va">cumulative_sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">my_dbl_vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cumulative_sum</span> <span class="op">&lt;-</span> <span class="va">cumulative_sum</span> <span class="op">+</span> <span class="va">i</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">cumulative_sum</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 55</code></pre>
</div>
</div>
<p>This is OK if we only do this calculation once, but it’s easy to imagine us wanting to repeat this calculation; for example, we might use calculate the cumulative sum of daily cases to get a weekly incidence over every week of a year. In this situation, we would want to create a function.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-27_976e0f96655762ae6ae7d908499b32bd">
<div class="sourceCode" id="cb91" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_cumsum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vector</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cumulative_sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">my_dbl_vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cumulative_sum</span> <span class="op">&lt;-</span> <span class="va">cumulative_sum</span> <span class="op">+</span> <span class="va">i</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">cumulative_sum</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_cumsum</span><span class="op">(</span><span class="va">my_dbl_vec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 55</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is obviously a contrived example because, as with many basic operations in <code>R</code>, there is already a function written to perform this calculation that does it in a much more performant and safer manner: <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code></p>
</div>
</div>
</div>
<p>For many of the manipulations we will want to perform, a <strong>function</strong> has already been written by someone else and put into a <strong>package</strong> that we can download, as we’ve <a href="#packages">already seen</a>.</p>
<section id="anonymous-functions" class="level3"><h3 class="anchored" data-anchor-id="anonymous-functions">Anonymous functions</h3>
<p>There is a special class of functions called anonymous functions that are worth being aware of, as we will use them quite extensively throughout this workshop. As the name might suggest, <strong>anonymous functions</strong> are functions that are not named, and therefore, not saved for re-use. You may, understandably, be wondering why we would want to use them, given we just make the case for functions replacing repeatable blocks of code. In some instances, we want to be able to perform multiple computations that require creating intermediate objects, but because we only need to use them once, we don’t save them save to our environment, potentially causing issues with conflicts (e.g., accidentally using an object we didn’t mean to, or overwriting existing ones by re-using the same object name). This gets into the broader concept of local vs global scopes, but that is too far beyond the scope of this workshop: see <a href="https://rstudio-education.github.io/hopr/environments.html#scoping-rules">Hands-On Programming with R</a> and <a href="https://adv-r.hadley.nz/functions.html?q=lexical#lexical-scoping">Advanced R</a> for more information. Let’s look at an example to see when we might want to use an anonymous function.</p>
<p>Throughout this workshop, we will make use of the <code>map_*()</code> series of functions from the <a href="https://purrr.tidyverse.org/">purrr</a> package. We’ll go into more detail about <code>purr::map()</code> <a href="#sec-map-functions">shortly</a>, but for now, imagine we have a <strong>vector</strong> of numbers, and we want to add <code>5</code> to each value before and multiplying by <code>10</code>. The <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> function takes a <strong>vector</strong> and a function, and outputs a <strong>double vector</strong>. We could write a function to perform this multiplication, but if we’re only going to do this operation once, it seems unnecessary.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-28_cbc4dc9b4f5f87358b0c639a59471ef3">
<div class="sourceCode" id="cb93" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="va">my_dbl_vec</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">add_five_val</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">+</span> <span class="fl">5</span></span>
<span></span>
<span>        <span class="va">add_five_val</span> <span class="op">*</span> <span class="fl">10</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]  60  70  80  90 100 110 120 130 140 150</code></pre>
</div>
<div class="sourceCode" id="cb95" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># only exists within the function</span></span>
<span><span class="va">add_five_val</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre data-code-line-numbers=""><code>Error in eval(expr, envir, enclos): object 'add_five_val' not found</code></pre>
</div>
</div>
<p>Here, we’ve specified the anonymous function to take the input <code>.x</code> and multiple each value by 10, and we did it without saving the function. This would be equivalent to writing this:</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-29_f97e4077203580ab6456e7f0e1ad2e23">
<div class="sourceCode" id="cb97" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">add_five_multiply_ten</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">add_five_val</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">5</span></span>
<span>    <span class="va">add_five_val</span> <span class="op">*</span> <span class="fl">10</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="va">my_dbl_vec</span>,</span>
<span>    .f <span class="op">=</span> <span class="op">~</span><span class="fu">add_five_multiply_ten</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]  60  70  80  90 100 110 120 130 140 150</code></pre>
</div>
<div class="sourceCode" id="cb99" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># only exists within the function</span></span>
<span><span class="va">add_five_val</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre data-code-line-numbers=""><code>Error in eval(expr, envir, enclos): object 'add_five_val' not found</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice the <code>~</code> used: this specifies that we want to pass arguments into our named function. Without it, we will get an error about <code>.x</code> not being found.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In this example, because we are doing standard arithmetic, <code>R</code> will <strong>vectorize</strong> our function so that it can automatically be applied to each element of the object, so this example was merely to illustrate the point.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-30_15d8279f8551101dd95136e371f6931e">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">add_five_multiply_ten</span><span class="op">(</span><span class="va">my_dbl_vec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  60  70  80  90 100 110 120 130 140 150</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="tidy-data" class="level2"><h2 class="anchored" data-anchor-id="tidy-data">Tidy data</h2>
<p>Before we look at the common packages and functions we use throughout this workshop, let’s take a second to talk about how our data is structured. For much of what we do, it is convenient to work with <strong>dataframes</strong>, and many functions we will use are designed to work with <em>long</em> <strong>dataframes</strong>. What this means is that each <em>column</em> represents a variable, and each row is a unique observation.</p>
<p>Let’s first look at a <strong>wide dataframe</strong> to see how data may be represented. Here, we have one column representing a number for each of the states in the US, and then we have two columns representing some random incidence: one for July and one for August.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-31_01b08bd4273eb67d54f0f231cb704328">
<div class="sourceCode" id="cb103" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wide_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    state_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">52</span>,</span>
<span>    july_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">1000</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    aug_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">1000</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">wide_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 3]
state_id int 1 2 3 4 5 6
july_inc int 409 385 426 397 398 417
aug_inc  int 570 616 607 597 607 609</code></pre>
</div>
</div>
<p>Instead, we reshape this into a <strong>long dataframe</strong> so that there is a column for the state ID, a column for the month, and a column for the incidence (that is associated with <em>both</em> the state <em>and</em> the month). Using the <a href="https://tidyr.tidyverse.org">tidyr</a> package, we could reshape this <strong>wide dataframe</strong> to be a <strong>long dataframe</strong> (see <a href="#sec-pivot-functions">this section</a> for more information about the <code>pivot_*()</code> functions)</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-32_37c6c3e6972bb05f645e45b797e1c898">
<div class="sourceCode" id="cb105" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">long_df</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">july_inc</span>, <span class="va">aug_inc</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"incidence"</span>,</span>
<span>    <span class="co"># Extract only the month using regex</span></span>
<span>    names_pattern <span class="op">=</span> <span class="st">"(.*)_inc"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">long_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [104, 3]
state_id  int 1 1 2 2 3 3
month     chr july aug july aug july aug
incidence int 409 570 385 616 426 607</code></pre>
</div>
</div>
<p>You will notice that our new dataframe contains three columns still, but is longer than previously; two time as long, in fact.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Particularly keen-eyed reader may also notice that <code>long_df</code> is also has class <strong>tibble</strong>, not a <strong>data.frame</strong>. A <strong>tibble</strong> effectively is a <strong>data.frame</strong>, but is an object commonly used and output by <a href="https://tidyverse.tidyverse.org">tidyverse</a> functions, as it has a few extra safety features over the base <strong>data.frame</strong>.</p>
</div>
</div>
</div>
</section><section id="core-code-used" class="level2"><h2 class="anchored" data-anchor-id="core-code-used">Core code used</h2>
<p>We’re finally ready to talk about the functions that are used throughout this workshop. The first package to mention is the <a href="https://tidyverse.tidyverse.org">tidyverse</a> package, which actually a collection of packages: the core packages can be found <a href="https://www.tidyverse.org/packages/">here</a>. The reason why are using the <a href="https://tidyverse.tidyverse.org">tidyverse</a> packages throughout this workshop is that they are relatively easily to learn, compared to base <code>R</code> and <a href="https://r-datatable.com">data.table</a> (not that they are mutually exclusive), and what most people are familiar with. They also are well designed and powerful, so you should be able to do most things you need using their packages.</p>
<p>You can find a list of cheatsheets for all of these packages (and more) <a href="https://posit.co/resources/cheatsheets/?type=posit-cheatsheets&amp;_page=1/">here</a>.</p>
<p>Let’s load the <a href="https://tidyverse.tidyverse.org">tidyverse</a> packages and then go through the key functions used. Unless stated explicitly, these packages will be available to you after loading the <a href="https://tidyverse.tidyverse.org">tidyverse</a> with the following command.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-33_522d51e3d4765de1641432283da26bd9">
<div class="sourceCode" id="cb107" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tibble" class="level3"><h3 class="anchored" data-anchor-id="tibble"><code>tibble()</code></h3>
<p>The <strong>tibble</strong> is a modern reincarnation of the <strong>dataframes</strong> that is slightly safer i.e., is more restricted in what you can do with it, and will throw errrors more frequently, but very rarely for anything other than a bug. We will use the terms interchangeably, as most people will just talk about <strong>dataframes</strong>, as for the most part, they can be treated identically. Use the same syntax as the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> function to create the <strong>tibble</strong>.</p>
</section><section id="dplyrfilter" class="level3"><h3 class="anchored" data-anchor-id="dplyrfilter"><code>dplyr::filter()</code></h3>
<p>If we wanted to take a subset of rows of a <strong>dataframe</strong>, we would use the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code> function. Here, we’re listing the package it’s coming from, as there are some other packages that also export their own version of the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function. However, for all the code in this workshop, there aren’t any concerns about <a href="#namespace-conflict"><strong>namespace conflicts</strong></a>, so we won’t use it from here on in.</p>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function is relatively simple to work with: you specify the <strong>dataframe</strong> variable you want to subset by, the filtering criteria, and that’s it. If we include multiple arguments, they get treated as <em>AND</em> statements (<code>&amp;</code>), so all conditions need to be met.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-34_f413472e322ec48ff1958d64e9940a17">
<div class="sourceCode" id="cb108" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">long_df</span>,</span>
<span>    <span class="va">month</span> <span class="op">==</span> <span class="st">"july"</span>,</span>
<span>    <span class="va">incidence</span> <span class="op">&gt;</span> <span class="fl">410</span></span>
<span>    <span class="co"># equivalent to: month == "july" &amp; incidence &gt; 410</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [11, 3]
state_id  int 3 6 14 17 19 23
month     chr july july july july july july
incidence int 426 417 413 413 413 414</code></pre>
</div>
</div>
<p>We can filter using <strong>OR</strong> statements (<code>|</code>), so if either condition returns <code>TRUE</code>, then it will be included in the subset.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-35_476d8cb536331d4c1ad89f84a020a8f0">
<div class="sourceCode" id="cb110" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">long_df</span>,</span>
<span>    <span class="va">month</span> <span class="op">==</span> <span class="st">"july"</span> <span class="op">|</span> <span class="va">incidence</span> <span class="op">&gt;</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [78, 3]
state_id  int 1 2 2 3 3 4
month     chr july july aug july aug july
incidence int 409 385 616 426 607 397</code></pre>
</div>
</div>
</section><section id="select" class="level3"><h3 class="anchored" data-anchor-id="select"><code>select()</code></h3>
<p>If, instead, we wanted to subset of columns of a <strong>dataframe</strong>, we would use the <code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code> function.</p>
<p>Let’s say, from our wide incidence data, we only want the state’s ID and their August incidence. We can directly select the columns this way.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-36_170484a0523e17a58ddf455fb66f4819">
<div class="sourceCode" id="cb112" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    <span class="va">state_id</span>, <span class="va">aug_inc</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 2]
state_id int 1 2 3 4 5 6
aug_inc  int 570 616 607 597 607 609</code></pre>
</div>
</div>
<p>But in this case, it would be more efficient (for us) to tell <code>R</code> the columns we <em>don’t</em> want. We can do that using the <code>-</code> sign.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-37_3c5bb0aa8b195a9e9910a4eb02f5b554">
<div class="sourceCode" id="cb114" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    <span class="op">-</span><span class="va">july_inc</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 2]
state_id int 1 2 3 4 5 6
aug_inc  int 570 616 607 597 607 609</code></pre>
</div>
</div>
<p>If there were multiple columns we didn’t want, we would pass them in a vector.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-38_cbb3c396aba27a3d3ee379d37461399f">
<div class="sourceCode" id="cb116" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">july_inc</span>, <span class="va">aug_inc</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 1]
state_id int 1 2 3 4 5 6</code></pre>
</div>
</div>
<p>When it comes to selecting columns, the <a href="https://tidyselect.r-lib.org">tidyselect</a> package has a few very handy functions for us. To understand when they are most useful, let’s first look at the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function, and then we’ll highlight how to use the different column selection functions available to use through <a href="https://tidyselect.r-lib.org">tidyselect</a>.</p>
</section><section id="mutate" class="level3"><h3 class="anchored" data-anchor-id="mutate"><code>mutate()</code></h3>
<p>If we have a <strong>dataframe</strong> and want to add or edit a column, we use the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function. Usually the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function is used to add a column that is related to the existing data, but it is not necessary. Below are examples of both.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-39_698772ffd2579d9dadd1987b4433ddbb">
<div class="sourceCode" id="cb118" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add September incidence that is based on August incidence</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    sep_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">aug_inc</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 4]
state_id int 1 2 3 4 5 6
july_inc int 409 385 426 397 398 417
aug_inc  int 570 616 607 597 607 609
sep_inc  dbl 694 715 723 727 722 715</code></pre>
</div>
<div class="sourceCode" id="cb120" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add random September incidence</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    sep_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">1000</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 4]
state_id int 1 2 3 4 5 6
july_inc int 409 385 426 397 398 417
aug_inc  int 570 616 607 597 607 609
sep_inc  int 693 707 690 719 719 710</code></pre>
</div>
</div>
<p>If we wanted to update a column, we can do that by specifying the column on both sides of the equals sign.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-40_fc6a42090880d956ff173614e4c32210">
<div class="sourceCode" id="cb122" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Update the August incidence to add random noise</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    aug_inc <span class="op">=</span> <span class="va">aug_inc</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 3]
state_id int 1 2 3 4 5 6
july_inc int 409 385 426 397 398 417
aug_inc  dbl 583 605 586 596 613 613</code></pre>
</div>
</div>
<p>One crucial thing to note is that <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> applies our function/operation to each row simultaneously, so the new column’s value only depends on the <em>row’s</em> original values (or the vector in the case of the second example that didn’t use the values from the data).</p>
</section><section id="paste0" class="level3"><h3 class="anchored" data-anchor-id="paste0"><code>paste0()</code></h3>
<p>The <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> function is useful for manipulating objects and coercing them into string, allowing us to do <em>string interpolation</em>. It comes installed with base <code>R</code>, so there’s nothing to install, and because of the way <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> works, apply functions to each row simultaneously, we can modify whole columns at once, depending on the row’s original values. It works to <em>squish</em> all the values together, without any separators by default. If you wanted spaces between your words, for example, you can use the <code>paste(..., sep = " ")</code> function, which takes the <code>sep</code> argument.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-41_cc10701ac9544489a820dfa3f8de6f2f">
<div class="sourceCode" id="cb124" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">char_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">long_df</span>,</span>
<span>    <span class="co"># Notice that text is in commas, and object values being passed to paste0()</span></span>
<span>    <span class="co"># are unquoted.</span></span>
<span>    state_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"state_"</span>, <span class="va">state_id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">char_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [104, 3]
state_id  chr state_1 state_1 state_2 state_2 state_3 state_3
month     chr july aug july aug july aug
incidence int 409 570 385 616 426 607</code></pre>
</div>
</div>
</section><section id="sec-glue" class="level3"><h3 class="anchored" data-anchor-id="sec-glue"><code>glue::glue()</code></h3>
<p><code>glue()</code> is a function that comes installed with <a href="https://tidyverse.tidyverse.org">tidyverse</a>, but is not loaded automatically, so you have to reference it explicitly by either using <code><a href="https://github.com/tidyverse/glue">library(glue)</a></code> or the <code>::</code> notation shown below. It serves the same purpose as the base <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, but in a slightly different syntax. Instead of using a mix of quotations and unquoted object names, <code>glue()</code> requires everything to be in quotation marks, with any value being passed to the <em>string interpolation</em> being <em>enclosed</em> in <code><a href="https://rdrr.io/r/base/Paren.html">{ }</a></code>. It is worth learning <code>glue()</code> as it is used throughout the <a href="https://tidyverse.tidyverse.org">tidyverse</a> packages, such as in the <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> function.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-42_aadbe1b7914455d85bbb47b233c76510">
<div class="sourceCode" id="cb126" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">char_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">long_df</span>,</span>
<span>    state_id <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"state_{state_id}"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">char_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [104, 3]
state_id  chr state_1 state_1 state_2 state_2 state_3 state_3
month     chr july aug july aug july aug
incidence int 409 570 385 616 426 607</code></pre>
</div>
</div>
</section><section id="str_replace_all" class="level3"><h3 class="anchored" data-anchor-id="str_replace_all"><code>str_replace_all()</code></h3>
<p>If we want to replace characters throughout the whole of a string vector, we can do that with the <code><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all()</a></code> function. And because <strong>dataframes</strong> are made up of individual <strong>vectors</strong>, we can use this to modify vectors.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-43_e3b348bdb39777f32bcef09f2113e495">
<div class="sourceCode" id="cb128" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">char_df</span>,</span>
<span>    <span class="co"># pass in the vector (a column, here), the pattern to remove, and the replacement</span></span>
<span>    clean_state_id <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">state_id</span>, <span class="st">"state_"</span>, <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [104, 4]
state_id       chr state_1 state_1 state_2 state_2 state_3 state_3
month          chr july aug july aug july aug
incidence      int 409 570 385 616 426 607
clean_state_id chr 1 1 2 2 3 3</code></pre>
</div>
</div>
</section><section id="across" class="level3"><h3 class="anchored" data-anchor-id="across"><code>across()</code></h3>
<p>Above, we were only <strong>mutating</strong> a single column at a time, which is what we often do. But, sometimes we want to apply the exact same transformation to multiple columns. For example, say we wanted to turn our monthly incidence data into the average weekly incidence. We could write out each transformation by hand, but when there are more than two columns, this gets rather tedious and introduces the opportunity for mistakes when copying code (one of our motivations for using functions). The <code>tidyselect::across()</code> function allows us to specify the columns we want to apply the transformation, and the function (can be named or anonymous), and that’s it.</p>
<p>There are a couple of points to understand about the code below:</p>
<ul>
<li>Note the <code>.</code> preceding the <code>cols</code>, <code>fns</code>, and <code>x</code>
</li>
<li>Each column is passed to the <code>.x</code> value in the function argument</li>
<li>
<code>~</code> is required to pass arguments into the function. In this case it is an anonymous function using the <a href="#sec-map-functions"><code>map_*()</code> syntax</a>.</li>
</ul>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-44_0e3f2f8500dd5ca88b588cb10eac9387">
<div class="sourceCode" id="cb130" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>        .cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">july_inc</span>, <span class="va">aug_inc</span><span class="op">)</span>,</span>
<span>        .fns <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op">*</span> <span class="fl">7</span> <span class="op">/</span> <span class="fl">30</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 3]
state_id int 1 2 3 4 5 6
july_inc dbl 95.433333 89.833333 99.4 92.633333 92.866667 97.3
aug_inc  dbl 133 143.733333 141.633333 139.3 141.633333 142.1</code></pre>
</div>
</div>
</section><section id="everything" class="level3"><h3 class="anchored" data-anchor-id="everything"><code>everything()</code></h3>
<p>If we wanted to select every column in a dataframe, we would use the <code><a href="https://tidyselect.r-lib.org/reference/everything.html">everything()</a></code> function. This may not seem helpful initially, but there are occasions when it’s very useful. For instance, in the previous example we still specified the exact columns we wanted to transform. However, if there were five times as many, we wouldn’t want to do that. Do note that if we replaced this with <code><a href="https://tidyselect.r-lib.org/reference/everything.html">everything()</a></code>, we would also <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> our <code>state_id</code> column, which we probably don’t want to do, so we could combine it with the <code>-</code> selection seen previously.</p>
</section><section id="contains" class="level3"><h3 class="anchored" data-anchor-id="contains"><code>contains()</code></h3>
<p>Another very handy function is the <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">tidyselect::contains()</a></code> function. This allows us to specify a string that the column names must <em>contain</em> for them to be selected. We could change the above example to look like this:</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-45_d506e68fabd2708f3f51f857b10ff38e">
<div class="sourceCode" id="cb132" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>        .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"_inc"</span><span class="op">)</span>,</span>
<span>        .fns <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op">*</span> <span class="fl">7</span> <span class="op">/</span> <span class="fl">30</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 3]
state_id int 1 2 3 4 5 6
july_inc dbl 95.433333 89.833333 99.4 92.633333 92.866667 97.3
aug_inc  dbl 133 143.733333 141.633333 139.3 141.633333 142.1</code></pre>
</div>
</div>
</section><section id="rename_with" class="level3"><h3 class="anchored" data-anchor-id="rename_with"><code>rename_with()</code></h3>
<p>If we wanted to rename columns of a <strong>dataframe</strong>, we can use the <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> function. However, like the previous <a href="https://tidyselect.r-lib.org">tidyselect</a> examples, sometimes we want to apply the same renaming scheme (function) to the columns. <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with()</a></code> allows us to pass a function to multiple columns at once, achieving what we want with minimal effort, and without needing to use <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-46_511e38cfd329a2a3d21feac7369826b1">
<div class="sourceCode" id="cb134" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"_inc"</span><span class="op">)</span>,</span>
<span>    .fn <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"_inc"</span>, <span class="st">"_incidence"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>data.frame [52, 3]
state_id       int 1 2 3 4 5 6
july_incidence int 409 385 426 397 398 417
aug_incidence  int 570 616 607 597 607 609</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hopefully you are noticing a pattern between the <a href="https://tidyselect.r-lib.org">tidyselect</a>-type functions. When you need to apply a function to multiple columns in a <strong>dataframe</strong>, you will select the columns with the <code>.cols</code> argument, and pass the function to the <code>.fn(s)</code> argument with the <code>~</code> symbol indicating you are using the <code>.x</code> to represent the column in the function (yes, there is a touch of ambiguity between <code>.fns</code> and <code>.fn</code>, but the general pattern holds). This will be useful when we look at the <code>map_*()</code> family of functions.</p>
</div>
</div>
</section><section id="magrittr" class="level3"><h3 class="anchored" data-anchor-id="magrittr"><code>magrittr::%&gt;%</code></h3>
<p>The <code>%&gt;%</code> operator is an interesting and very useful function that comes installed (and loaded) with the <a href="https://tidyverse.tidyverse.org">tidyverse</a> package (technically from the <a href="https://magrittr.tidyverse.org">magrittr</a> package from within the <a href="https://tidyverse.tidyverse.org">tidyverse</a>). It allows us to chain together operations without needing to create intermediate objects. Say for example we have our wide incidence data and want to add data for September before turning it into a <strong>long dataframe</strong>, we could create and intermediate object before using the <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> function from before, but we might not want to create another object that we don’t really care about. This is when we would want to use a pipe, as it takes the output of one operation and <em>pipes</em> it into the next one.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-47_23aa1abebd37970532239c89dbf8b63c">
<div class="sourceCode" id="cb136" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">wide_df</span>,</span>
<span>    sep_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">aug_inc</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>        cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">july_inc</span>, <span class="va">aug_inc</span>, <span class="va">sep_inc</span><span class="op">)</span>,</span>
<span>        names_to <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>        values_to <span class="op">=</span> <span class="st">"incidence"</span>,</span>
<span>        names_pattern <span class="op">=</span> <span class="st">"(.*)_inc"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">.</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [156, 3]
state_id  int 1 1 1 2 2 2
month     chr july aug sep july aug sep
incidence dbl 409 570 689 385 616 731</code></pre>
</div>
</div>
<p>By default, the previous object gets input into the first argument of the next function, but here we’ve shown that you can manipulate the position the object is <em>piped</em> into by specify the argument using the <code>.</code> syntax.</p>
</section><section id="section" class="level3"><h3 class="anchored" data-anchor-id="section"><code>|&gt;</code></h3>
<p>In <code>R</code> version 4.1.0, the <code>|&gt;</code> was added as the base pipe operator. It works slightly differently to <code>%&gt;%</code>, and frankly, is less powerful and less common (at the moment), so we won’t use it in this workshop.</p>
</section><section id="group_by" class="level3"><h3 class="anchored" data-anchor-id="group_by"><code>group_by()</code></h3>
<p>If we have groups in our <strong>dataframe</strong> and want to apply some function to each group’s data, we can use the <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> function. For example, if we wanted to calculate the mean and median incidence in our fake data from earlier, but group it by the month.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-48_b3482532c2f48eb8c5e7a6e2b8597d90">
<div class="sourceCode" id="cb138" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">long_df</span>, <span class="va">month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span>, median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [2, 3]
month  chr aug july
mean   dbl 601.403846 398.461538
median dbl 600.5 399.5</code></pre>
</div>
</div>
</section><section id="sec-pivot-functions" class="level3"><h3 class="anchored" data-anchor-id="sec-pivot-functions"><code>pivot_*()</code></h3>
<p>We’ve <a href="#tidy-data">already seen</a> the purpose of the <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> function: taking wide data and reshaping it to be long. There is an equivalent to go from long to wide: <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>. Occassionally this is useful (though it is less common than creating long data).</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-49_6bd25d253633bbd5ad6f126b5a6b7a06">
<div class="sourceCode" id="cb140" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    <span class="va">long_df</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">month</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">incidence</span>,</span>
<span>    names_glue <span class="op">=</span> <span class="st">"{month}_inc"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [52, 3]
state_id int 1 2 3 4 5 6
july_inc int 409 385 426 397 398 417
aug_inc  int 570 616 607 597 607 609</code></pre>
</div>
</div>
<p>Here, the <code>names_glue</code> argument is making use of the <code><a href="https://glue.tidyverse.org/reference/glue.html">glue::glue()</a></code> function (<a href="#sec-glue">see above</a>) that is installed with <a href="https://tidyverse.tidyverse.org">tidyverse</a>, but not loaded automatically for use by the users.</p>
</section><section id="sec-map-functions" class="level3"><h3 class="anchored" data-anchor-id="sec-map-functions"><code>map_*()</code></h3>
<p>The <code>map_*()</code> functions come from the <a href="https://purrr.tidyverse.org/">purrr</a> package (a core part of the <a href="https://tidyverse.tidyverse.org">tidyverse</a>), and are incredibly useful. They are relatively complicated, so there isn’t enough space to go into full detail, but here we’ll just outline enough so you can read more and understand what’s going on.</p>
<p>We’ve <a href="#anonymous-functions">already seen</a> we can apply functions to each element of a vector (<strong>atomic</strong> or <strong>list</strong> vectors). The key points to note are the <code>.</code> preceding the <code>x</code> and <code>f</code> arguments. If we use <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> we get a <strong>list</strong> returned, <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> a <strong>double vector</strong>, <code>map_char()</code> a <strong>character vector</strong>, <code><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr()</a></code> a <strong>dataframe</strong> etc.</p>
<p>In the example below, we’ll walk through <code><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr()</a></code> as it’s one of the more confusing variants due to the <strong>return</strong> requirements.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-50_62f02424a17e5c42972d86041d43a667">
<div class="sourceCode" id="cb142" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map_dfr_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="va">my_dbl_vec</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Note we don't use , at the end of each line - it's as if we were</span></span>
<span>        <span class="co"># running the code in the console</span></span>
<span>        <span class="va">times_ten</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">*</span> <span class="fl">10</span></span>
<span>        <span class="va">divide_ten</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">/</span> <span class="fl">10</span></span>
<span></span>
<span>        <span class="co"># construct a tibble as normal (requires , between arguments)</span></span>
<span>        <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>            original_val <span class="op">=</span> <span class="va">.x</span>,</span>
<span>            times_ten <span class="op">=</span> <span class="va">times_ten</span>,</span>
<span>            divide_ten <span class="op">=</span> <span class="va">divide_ten</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_dfr_example</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [10, 3]
original_val int 1 2 3 4 5 6
times_ten    dbl 10 20 30 40 50 60
divide_ten   dbl 0.1 0.2 0.3 0.4 0.5 0.6</code></pre>
</div>
</div>
<p>What’s happening under the hood is that <code><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr()</a></code> is applying the <a href="#anonymous-functions">anonymous function</a> we defined to each element in our vector and returning a <strong>list</strong> of <strong>dataframes</strong> that contains one row and three columns, i.e.&nbsp;for the first element, we would get this:</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-51_8d241ab922a36c191c03589d1b24f4fe">
<div class="sourceCode" id="cb144" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">map_dfr_example</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
tibble [1, 3]
original_val int 1
times_ten    dbl 10
divide_ten   dbl 0.1</code></pre>
</div>
</div>
<p>It then calls the <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows()</a></code> function to <em>squash</em> all of those <strong>dataframes</strong> together, one row stacked on top of the next, to create one large <strong>dataframe</strong>. We could write the equivalent code like this:</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-52_4a5a2a4a607420ed770802f84f476deb">
<div class="sourceCode" id="cb146" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="va">my_dbl_vec</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Note we don't use , at the end of each line - it's as if we were</span></span>
<span>        <span class="co"># running the code in the console</span></span>
<span>        <span class="va">times_ten</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">*</span> <span class="fl">10</span></span>
<span>        <span class="va">divide_ten</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">/</span> <span class="fl">10</span></span>
<span></span>
<span>        <span class="co"># construct a tibble as normal (requires , between arguments)</span></span>
<span>        <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>            original_val <span class="op">=</span> <span class="va">.x</span>,</span>
<span>            times_ten <span class="op">=</span> <span class="va">times_ten</span>,</span>
<span>            divide_ten <span class="op">=</span> <span class="va">divide_ten</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>tibble [10, 3]
original_val int 1 2 3 4 5 6
times_ten    dbl 10 20 30 40 50 60
divide_ten   dbl 0.1 0.2 0.3 0.4 0.5 0.6</code></pre>
</div>
</div>
<p><code><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfc()</a></code> does exactly the same thing, but calls <code><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols()</a></code> instead, to place the columns next to each other.</p>
<p>There is one more important variant to go through: <code>pmap_*()</code>. If <code>map_*()</code> takes one vector as an argument, <code>pmap_*()</code> takes a <strong>list</strong> of arguments. What this means is that we can iterate through the elements of as many arguments as we’d like, <em>in sequence</em>. For example, let’s multiply the elements of two <strong>double</strong> vectors together.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-53_d5b48fbfd5d97df7e034a09e4ae5463a">
<div class="sourceCode" id="cb148" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a second vector of numbers</span></span>
<span><span class="va">my_second_dbl_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">my_dbl_vec</span><span class="op">)</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">my_second_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]  -4.5467960  58.7646464  11.9674614   6.3449418   0.3516119  13.9808862
 [7]  44.0870301  35.1745519  -9.0811311 -22.3804141</code></pre>
</div>
<div class="sourceCode" id="cb150" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Remind ourselves what our original vector looks like</span></span>
<span><span class="va">my_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode" id="cb152" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html">pmap_dbl</a></span><span class="op">(</span></span>
<span>    .l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>first_num <span class="op">=</span> <span class="va">my_dbl_vec</span>, sec_num <span class="op">=</span> <span class="va">my_second_dbl_vec</span><span class="op">)</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">first_num</span>, <span class="va">sec_num</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">first_num</span> <span class="op">*</span> <span class="va">sec_num</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]   -4.546796  117.529293   35.902384   25.379767    1.758059   83.885317
 [7]  308.609211  281.396416  -81.730180 -223.804141</code></pre>
</div>
</div>
<p>There are a couple of important points to note here:</p>
<ul>
<li>All vectors need to be the same length</li>
<li>The function is applied to each element index of the input vectors, i.e., the first elements of the vectors are multiplied together, the second element of the vectors are multiplied together, and so on, until the last elements are reached.</li>
<li>We use <code>.l</code> instead of <code>.x</code> to denote we are passing a <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> of vectors.</li>
<li>Our function specifies the names of the vectors in the <code><a href="https://rdrr.io/r/base/list.html">list()</a></code>, which are then used within the function itself (similar to how we used <code>.x</code> in our <code>map_*()</code> functions)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As before, this is an unnecessary approach as <code>R</code> would vectorize the operation, but it is useful to demonstrate the principle.</p>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-54_23ff0d7af3f2fecf1b527a208b411726">
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dbl_vec</span> <span class="op">*</span> <span class="va">my_second_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   -4.546796  117.529293   35.902384   25.379767    1.758059   83.885317
 [7]  308.609211  281.396416  -81.730180 -223.804141</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="nest" class="level3"><h3 class="anchored" data-anchor-id="nest"><code>nest()</code></h3>
</section><section id="ggplot" class="level3"><h3 class="anchored" data-anchor-id="ggplot"><code>ggplot()</code></h3>
<section id="facet_wrap" class="level4"><h4 class="anchored" data-anchor-id="facet_wrap"><code>facet_wrap()</code></h4>
</section></section><section id="section-1" class="level3"><h3 class="anchored" data-anchor-id="section-1"><code>%*%</code></h3>
<p>This is the matrix multiplication operator. It works exactly as you’d expect given matrix multiplication rules. As such, you can use it on any combination of vectors and matrices.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>As you can see below, <code>R</code> treats vectors as dimensionless, and will try to convert it to either a <em>row</em> or <em>column</em> vector, depending on what makes sense for the matrix multiplication</p>
</div>
</div>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-55_c505d3f5eacb41d75126c8ae7278336b">
<div class="sourceCode" id="cb156" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dbl_vec</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">my_second_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>         [,1]
[1,] 544.3793</code></pre>
</div>
</div>
<div class="cell" data-hash="just-enough-r_cache/html/unnamed-chunk-56_09dc79fc15c9f5b13fc7eb13f4e1f29d">
<div class="sourceCode" id="cb158" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">my_matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>      [,1] [,2] [,3] [,4] [,5] [,6]
 [1,]    1   11   21   31   41   51
 [2,]    2   12   22   32   42   52
 [3,]    3   13   23   33   43   53
 [4,]    4   14   24   34   44   54
 [5,]    5   15   25   35   45   55
 [6,]    6   16   26   36   46   56
 [7,]    7   17   27   37   47   57
 [8,]    8   18   28   38   48   58
 [9,]    9   19   29   39   49   59
[10,]   10   20   30   40   50   60</code></pre>
</div>
<div class="sourceCode" id="cb160" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode" id="cb162" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dbl_vec</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">my_matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]  385  935 1485 2035 2585 3135</code></pre>
</div>
<div class="sourceCode" id="cb164" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">my_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre data-code-line-numbers=""><code>Error in my_matrix %*% my_dbl_vec: non-conformable arguments</code></pre>
</div>
<div class="sourceCode" id="cb166" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">my_dbl_vec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre data-code-line-numbers=""><code>Error in my_matrix %*% t(my_dbl_vec): non-conformable arguments</code></pre>
</div>
<div class="sourceCode" id="cb168" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">my_matrix</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">my_dbl_vec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     [,1]
[1,]  385
[2,]  935
[3,] 1485
[4,] 2035
[5,] 2585
[6,] 3135</code></pre>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./just-enough-rstudio.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Just Enough RStudio</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./project-management.html" class="pagination-link">
        <span class="nav-page-text">Organizing A Project</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb170" data-shortcodes="false" data-code-line-numbers=""><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co">    html:</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="co">        code-fold: false</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co">        code-line-numbers: false</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Just Enough R {.unnumbered}</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>The purpose of this section is to get you up-to-speed with <span class="in">`R`</span>.</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>If you're completely unfamiliar with <span class="in">`R`</span> and RStudio, this should provide you with enough to get started and understand what's going on in the code (and you can always refer back to this page if you understandably get a little lost), and if you have some experience, then it should provide a sufficient description of the packages and functions that we use in this workshop.</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>Now you have <span class="in">`R`</span> set installed and you can access it using RStudio, it's time to learn some of the core features of the language (see <span class="co">[</span><span class="ot">below</span><span class="co">](#rstudio)</span> for details about using RStudio).</span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>We'd strongly recommend you read <span class="co">[</span><span class="ot">Hands-On Programming With R</span><span class="co">](https://rstudio-education.github.io/hopr)</span> by Garett Grolemund and <span class="co">[</span><span class="ot">R for DataScience</span><span class="co">](https://r4ds.hadley.nz/)</span> by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund for a deeper understanding of the following concepts (and many more).</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objects &amp; types introduction</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>An object is anything you can create in R using code, whether that is a table you import from a **csv** file (that will get converted to a **dataframe**), or a **vector** you create within a script.</span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>Each object you create has a **type**.</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>We've already mentioned two (**dataframes** and **vectors**), but there are plenty more.</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>But before we get into object types, let's take a step back and look at types in general, thinking about individual elements and the fundamentals.</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Element types</span></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>Generally in programming, we have two broad types of numbers: **floating point** and **integer** numbers, i.e., numbers with decimals, and whole numbers, respectively.</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>In <span class="in">`R`</span>, we have these number types, but a **floating point** number is called a **double**.</span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a>The **floating point** number is the default type <span class="in">`R`</span> assigns to number: look at the types assigned when we leave off a decimal place vs. specify type integer by ending a number with an <span class="in">`L`</span>.</span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">1</span>)</span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(1L)</span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a>Technically type **double** is a subset of type **numeric**, so you will often see people convert numbers to floating points using <span class="in">`as.numeric()`</span>, rather than <span class="in">`as.double()`</span>, but the different is semantics.</span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a>You can confirm this using the command `typeof(as.numeric(10)) == typeof(as.double(10))semantics.</span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a>You can confirm this using the command <span class="in">`typeof(as.numeric(10)) == typeof(as.double(10))`</span>.</span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a>Integer types are not commonly used in <span class="in">`R`</span>, but there are occasions when you will want to use them e.g., when you need whole numbers of people in a simulation you may want to use integers to enforce this.</span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a>Integers are also slightly more precise (unless very big or small), so when exactness in whole number is required, you may want to use integers.</span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-49"><a href="#cb170-49" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-50"><a href="#cb170-50" aria-hidden="true" tabindex="-1"></a><span class="in">`R`</span> has some idiosyncrasies when it comes to numbers.</span>
<span id="cb170-51"><a href="#cb170-51" aria-hidden="true" tabindex="-1"></a>For the most part, **doubles** are produced, but occasionally an **integer** will be produced when you are expecting a **double**.</span>
<span id="cb170-52"><a href="#cb170-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-53"><a href="#cb170-53" aria-hidden="true" tabindex="-1"></a>For example:</span>
<span id="cb170-54"><a href="#cb170-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-57"><a href="#cb170-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-58"><a href="#cb170-58" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">1</span>)</span>
<span id="cb170-59"><a href="#cb170-59" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb170-60"><a href="#cb170-60" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>))</span>
<span id="cb170-61"><a href="#cb170-61" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb170-62"><a href="#cb170-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-63"><a href="#cb170-63" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-64"><a href="#cb170-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-65"><a href="#cb170-65" aria-hidden="true" tabindex="-1"></a>Outside of numbers, we have **characters** (**strings**) and **boolean** types.</span>
<span id="cb170-66"><a href="#cb170-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-67"><a href="#cb170-67" aria-hidden="true" tabindex="-1"></a>A **boolean** (also known as a **logical** in <span class="in">`R`</span>) is a <span class="in">`TRUE/FALSE`</span> statement.</span>
<span id="cb170-68"><a href="#cb170-68" aria-hidden="true" tabindex="-1"></a>In <span class="in">`R`</span>, as in many programming languages, <span class="in">`TRUE`</span> is equal to a value of 1, and <span class="in">`FALSE`</span> equals <span class="in">`0`</span>.</span>
<span id="cb170-69"><a href="#cb170-69" aria-hidden="true" tabindex="-1"></a>There are times when this comes in handy e.g. you need to calculate the number of people that responded to a question, and their responses is coded as <span class="in">`TRUE/FALSE`</span>, you can just sum the **vector** of responses (more on **vectors** shortly).</span>
<span id="cb170-70"><a href="#cb170-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-71"><a href="#cb170-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-74"><a href="#cb170-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-75"><a href="#cb170-75" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb170-76"><a href="#cb170-76" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb170-77"><a href="#cb170-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-78"><a href="#cb170-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-79"><a href="#cb170-79" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Question" appearance="minimal"}</span>
<span id="cb170-80"><a href="#cb170-80" aria-hidden="true" tabindex="-1"></a>Can you figure out what value will be returned for the command <span class="in">`(TRUE == 0) == FALSE`</span>?</span>
<span id="cb170-81"><a href="#cb170-81" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-82"><a href="#cb170-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-83"><a href="#cb170-83" aria-hidden="true" tabindex="-1"></a>A **character** is anything in quotation marks.</span>
<span id="cb170-84"><a href="#cb170-84" aria-hidden="true" tabindex="-1"></a>This would typically by letter, but is occasionally a number, or other symbol.</span>
<span id="cb170-85"><a href="#cb170-85" aria-hidden="true" tabindex="-1"></a>Other languages make a distinction between **characters** and **strings**, but not <span class="in">`R`</span>.</span>
<span id="cb170-86"><a href="#cb170-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-87"><a href="#cb170-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-90"><a href="#cb170-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-91"><a href="#cb170-91" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="st">"a"</span>)</span>
<span id="cb170-92"><a href="#cb170-92" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="st">"1"</span>)</span>
<span id="cb170-93"><a href="#cb170-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-94"><a href="#cb170-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-95"><a href="#cb170-95" aria-hidden="true" tabindex="-1"></a>It is important to note that characters are not **parsed** i.e., they are not interpreted by `R` as anything other than a **character**.</span>
<span id="cb170-96"><a href="#cb170-96" aria-hidden="true" tabindex="-1"></a>This means that despite <span class="in">`"1"`</span> looking like the number <span class="in">`1`</span>, it behaves like a **character** in `R`, not a **double**, so we can't do addition etc. with it.</span>
<span id="cb170-97"><a href="#cb170-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-98"><a href="#cb170-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-101"><a href="#cb170-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-102"><a href="#cb170-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb170-103"><a href="#cb170-103" aria-hidden="true" tabindex="-1"></a><span class="st">"1"</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb170-104"><a href="#cb170-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-105"><a href="#cb170-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-106"><a href="#cb170-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Object types</span></span>
<span id="cb170-107"><a href="#cb170-107" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vectors</span></span>
<span id="cb170-108"><a href="#cb170-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-109"><a href="#cb170-109" aria-hidden="true" tabindex="-1"></a>As mentioned, anything you can create in <span class="in">`R`</span> is an object.</span>
<span id="cb170-110"><a href="#cb170-110" aria-hidden="true" tabindex="-1"></a>For example, we can create an character object with the assignment operator (<span class="in">`&lt;-`</span>).</span>
<span id="cb170-111"><a href="#cb170-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-114"><a href="#cb170-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-115"><a href="#cb170-115" aria-hidden="true" tabindex="-1"></a>my_char_obj <span class="ot">&lt;-</span> <span class="st">"a"</span></span>
<span id="cb170-116"><a href="#cb170-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-117"><a href="#cb170-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-118"><a href="#cb170-118" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-119"><a href="#cb170-119" aria-hidden="true" tabindex="-1"></a>In other languages, <span class="in">`=`</span> is used for assignment.</span>
<span id="cb170-120"><a href="#cb170-120" aria-hidden="true" tabindex="-1"></a>In <span class="in">`R`</span>, this is generally avoided to distinguish between creating objects (assignment), and specifying argument values (see the <span class="co">[</span><span class="ot">section on functions</span><span class="co">](#functions)</span>).</span>
<span id="cb170-121"><a href="#cb170-121" aria-hidden="true" tabindex="-1"></a>However, despite what some purists may say, it really doesn't matter which one you use, from a practical standpoint.</span>
<span id="cb170-122"><a href="#cb170-122" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-123"><a href="#cb170-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-124"><a href="#cb170-124" aria-hidden="true" tabindex="-1"></a>You will note that when we created our object, it did not return a value (unlike the previous examples, a value was not printed).</span>
<span id="cb170-125"><a href="#cb170-125" aria-hidden="true" tabindex="-1"></a>To retrieve the value of the object (in this case, just print it), we just type out the object name.</span>
<span id="cb170-126"><a href="#cb170-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-129"><a href="#cb170-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-130"><a href="#cb170-130" aria-hidden="true" tabindex="-1"></a>my_char_obj</span>
<span id="cb170-131"><a href="#cb170-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-132"><a href="#cb170-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-133"><a href="#cb170-133" aria-hidden="true" tabindex="-1"></a>In this case, we just create an object with only one element.</span>
<span id="cb170-134"><a href="#cb170-134" aria-hidden="true" tabindex="-1"></a>We can check this using the <span class="in">`length()`</span> function.</span>
<span id="cb170-135"><a href="#cb170-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-138"><a href="#cb170-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-139"><a href="#cb170-139" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(my_char_obj)</span>
<span id="cb170-140"><a href="#cb170-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-141"><a href="#cb170-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-142"><a href="#cb170-142" aria-hidden="true" tabindex="-1"></a>We could also create an **atomic vector** (commonly just called a **vector**, which we'll use from here-on in).</span>
<span id="cb170-143"><a href="#cb170-143" aria-hidden="true" tabindex="-1"></a>In fact, <span class="in">`my_char_obj`</span> is actually an **vector**, i.e., it is a vector of length 1, as we've just seen.</span>
<span id="cb170-144"><a href="#cb170-144" aria-hidden="true" tabindex="-1"></a>Generally, a **vector** is an object that contains multiple elements that each have the same type.</span>
<span id="cb170-145"><a href="#cb170-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-148"><a href="#cb170-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-149"><a href="#cb170-149" aria-hidden="true" tabindex="-1"></a>my_char_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span>
<span id="cb170-150"><a href="#cb170-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-151"><a href="#cb170-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-152"><a href="#cb170-152" aria-hidden="true" tabindex="-1"></a>As we'll see in the example below, we can give each element in a **vector** a name, and to highlight that vectors must contain elements of the same type, watch what happens here.</span>
<span id="cb170-153"><a href="#cb170-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-156"><a href="#cb170-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-157"><a href="#cb170-157" aria-hidden="true" tabindex="-1"></a>my_named_char_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="st">"a"</span>, <span class="at">b =</span> <span class="st">"b"</span>, <span class="at">c =</span> <span class="st">"c"</span>, <span class="at">d =</span> <span class="dv">1</span>)</span>
<span id="cb170-158"><a href="#cb170-158" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(my_named_char_vec)</span>
<span id="cb170-159"><a href="#cb170-159" aria-hidden="true" tabindex="-1"></a>my_named_char_vec</span>
<span id="cb170-160"><a href="#cb170-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-161"><a href="#cb170-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-162"><a href="#cb170-162" aria-hidden="true" tabindex="-1"></a>Because <span class="in">`R`</span> saw the majority of the first elements in the **vector** were of type **character** it **coerced** the number to a **character**.</span>
<span id="cb170-163"><a href="#cb170-163" aria-hidden="true" tabindex="-1"></a>This is super important to be aware of, as it can cause errors, particularly when coercion goes in the other direction i.e. trying to create a **numeric vector**.</span>
<span id="cb170-164"><a href="#cb170-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-165"><a href="#cb170-165" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Factors</span></span>
<span id="cb170-166"><a href="#cb170-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-167"><a href="#cb170-167" aria-hidden="true" tabindex="-1"></a>All the **vector** types we've mentioned so far map nicely to their corresponding **element** types.</span>
<span id="cb170-168"><a href="#cb170-168" aria-hidden="true" tabindex="-1"></a>But there is an extension of the **character** vector used frequently: the **factor** (and, correspondingly, the **ordered** vector).</span>
<span id="cb170-169"><a href="#cb170-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-170"><a href="#cb170-170" aria-hidden="true" tabindex="-1"></a>A **factor** is a **vector** where there are distinct groups that exist within a **vector** i.e., they are *nominal categorical data*.</span>
<span id="cb170-171"><a href="#cb170-171" aria-hidden="true" tabindex="-1"></a>For example, we often include gender as a covariate in epidemiological analysis.</span>
<span id="cb170-172"><a href="#cb170-172" aria-hidden="true" tabindex="-1"></a>There is no intrinsic order, but we would want to account for the groups in the analysis.</span>
<span id="cb170-173"><a href="#cb170-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-174"><a href="#cb170-174" aria-hidden="true" tabindex="-1"></a>An **ordered vector** is when there *is* an intrinsic order to the grouping i.e., we have *ordinal categorical data*.</span>
<span id="cb170-175"><a href="#cb170-175" aria-hidden="true" tabindex="-1"></a>If, for example, we were interested in how the frequency of cigarette smoking is related to an outcome, and we wanted to use *binned* groups, rather than treating it as a continuous value, we would want to create an **ordered vector** as the ordering of the different groupings is important.</span>
<span id="cb170-176"><a href="#cb170-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-177"><a href="#cb170-177" aria-hidden="true" tabindex="-1"></a>Let's use the <span class="in">`mtcars`</span> dataset (that comes installed with <span class="in">`R`</span>), and turn the number of cylinders (<span class="in">`cyl`</span>) into an **ordered vector**, as there are discrete numbers of cylinders a car engine can have, *and* the ordering matters.</span>
<span id="cb170-178"><a href="#cb170-178" aria-hidden="true" tabindex="-1"></a>Don't worry about what <span class="in">`$`</span> is doing; we'll come to that <span class="co">[</span><span class="ot">later</span><span class="co">](#indexing-objects)</span></span>
<span id="cb170-179"><a href="#cb170-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-182"><a href="#cb170-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-183"><a href="#cb170-183" aria-hidden="true" tabindex="-1"></a>my_mtcars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb170-184"><a href="#cb170-184" aria-hidden="true" tabindex="-1"></a>my_mtcars<span class="sc">$</span>cyl</span>
<span id="cb170-185"><a href="#cb170-185" aria-hidden="true" tabindex="-1"></a>my_mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">ordered</span>(my_mtcars<span class="sc">$</span>cyl)</span>
<span id="cb170-186"><a href="#cb170-186" aria-hidden="true" tabindex="-1"></a>my_mtcars<span class="sc">$</span>cyl</span>
<span id="cb170-187"><a href="#cb170-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-188"><a href="#cb170-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-189"><a href="#cb170-189" aria-hidden="true" tabindex="-1"></a>If we wanted to directly specify the ordering of the groups, we can do this using the <span class="in">`levels`</span> argument i.e.</span>
<span id="cb170-190"><a href="#cb170-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-193"><a href="#cb170-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-194"><a href="#cb170-194" aria-hidden="true" tabindex="-1"></a>my_mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">ordered</span>(my_mtcars<span class="sc">$</span>cyl, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb170-195"><a href="#cb170-195" aria-hidden="true" tabindex="-1"></a>my_mtcars<span class="sc">$</span>cyl</span>
<span id="cb170-196"><a href="#cb170-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-197"><a href="#cb170-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-198"><a href="#cb170-198" aria-hidden="true" tabindex="-1"></a>To create a **factor**, just replace the <span class="in">`ordered()`</span> call with <span class="in">`factor()`</span></span>
<span id="cb170-199"><a href="#cb170-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-200"><a href="#cb170-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-201"><a href="#cb170-201" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lists</span></span>
<span id="cb170-202"><a href="#cb170-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-203"><a href="#cb170-203" aria-hidden="true" tabindex="-1"></a>There is another type of **vector**: the **list**.</span>
<span id="cb170-204"><a href="#cb170-204" aria-hidden="true" tabindex="-1"></a>Most people do not refer to **lists** as type of **vectors**, so we will only refer to them as **lists**, and **atomic vectors** will just be referred to as **vectors**.</span>
<span id="cb170-205"><a href="#cb170-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-206"><a href="#cb170-206" aria-hidden="true" tabindex="-1"></a>Unlike **vectors** there are no requirements about the form of **lists** i.e., each element of the **list** can be completely different.</span>
<span id="cb170-207"><a href="#cb170-207" aria-hidden="true" tabindex="-1"></a>One element could store a **vector** of numbers, another a model object, another a **dataframe**, and another a **list** (i.e. a nested **list**).</span>
<span id="cb170-208"><a href="#cb170-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-211"><a href="#cb170-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-212"><a href="#cb170-212" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb170-213"><a href="#cb170-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb170-214"><a href="#cb170-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glm</span>(mpg <span class="sc">~</span> <span class="fu">ordered</span>(cyl) <span class="sc">+</span> disp <span class="sc">+</span> hp, <span class="at">data =</span> mtcars),</span>
<span id="cb170-215"><a href="#cb170-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">column_1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">column_2 =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb170-216"><a href="#cb170-216" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-217"><a href="#cb170-217" aria-hidden="true" tabindex="-1"></a>my_named_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb170-218"><a href="#cb170-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">my_vec =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb170-219"><a href="#cb170-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">my_model =</span> <span class="fu">glm</span>(mpg <span class="sc">~</span> <span class="fu">ordered</span>(cyl) <span class="sc">+</span> disp <span class="sc">+</span> hp, <span class="at">data =</span> my_mtcars),</span>
<span id="cb170-220"><a href="#cb170-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">my_dataframe =</span> <span class="fu">data.frame</span>(<span class="at">column_1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">column_2 =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb170-221"><a href="#cb170-221" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-222"><a href="#cb170-222" aria-hidden="true" tabindex="-1"></a>my_list</span>
<span id="cb170-223"><a href="#cb170-223" aria-hidden="true" tabindex="-1"></a>my_named_list</span>
<span id="cb170-224"><a href="#cb170-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-225"><a href="#cb170-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-226"><a href="#cb170-226" aria-hidden="true" tabindex="-1"></a>Similar to **vectors**, **lists** can be named, or unnamed, and also that we they display in slightly different ways: when unnamed, we get the notation `[[1]] ... [[3]]` to denote the different **list** elements, and with the **named list** we get <span class="in">`$my_vec ... $my_dataframe`</span>.</span>
<span id="cb170-227"><a href="#cb170-227" aria-hidden="true" tabindex="-1"></a>It is often useful to name them, though, as it gives you some useful options when it comes to indexing and extracting values later.</span>
<span id="cb170-228"><a href="#cb170-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-229"><a href="#cb170-229" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-230"><a href="#cb170-230" aria-hidden="true" tabindex="-1"></a>If you're wondering why we are creating our list elements with the <span class="in">`=`</span> operator, that's because we can think of this as an argument in the <span class="in">`list()`</span> function, where the argument name is the name we want the element to have, and the argument value is the element itself.</span>
<span id="cb170-231"><a href="#cb170-231" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-232"><a href="#cb170-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-233"><a href="#cb170-233" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataframes</span></span>
<span id="cb170-234"><a href="#cb170-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-235"><a href="#cb170-235" aria-hidden="true" tabindex="-1"></a>**Dataframes** are the last key object type to learn about.</span>
<span id="cb170-236"><a href="#cb170-236" aria-hidden="true" tabindex="-1"></a>A **dataframe** is technically a special type of list.</span>
<span id="cb170-237"><a href="#cb170-237" aria-hidden="true" tabindex="-1"></a>Effectively, it is a 2-D table where every column has to have elements of the same type (i.e., is a **vector**), but the columns can be different types to each other.</span>
<span id="cb170-238"><a href="#cb170-238" aria-hidden="true" tabindex="-1"></a>The other important restriction is that all columns must be the same length, i.e. we have a rectangular **dataframe**.</span>
<span id="cb170-239"><a href="#cb170-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-240"><a href="#cb170-240" aria-hidden="true" tabindex="-1"></a>As we've seen before, we can create a dataframe using this code, where <span class="in">`1:5`</span> is shorthand for a vector that contains the sequence of numbers from 1 to 5, inclusive (i.e., <span class="in">`c(1, 2, 3, 4, 5)`</span>).</span>
<span id="cb170-241"><a href="#cb170-241" aria-hidden="true" tabindex="-1"></a>We could also write this sequence as <span class="in">`seq(1, 5, by = 1)`</span>, allowing us more control over the steps in the sequence.</span>
<span id="cb170-242"><a href="#cb170-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-245"><a href="#cb170-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-246"><a href="#cb170-246" aria-hidden="true" tabindex="-1"></a>my_dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb170-247"><a href="#cb170-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_int =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb170-248"><a href="#cb170-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_dbl =</span> <span class="fu">seq</span>(<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">1</span>),</span>
<span id="cb170-249"><a href="#cb170-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_3 =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb170-250"><a href="#cb170-250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-251"><a href="#cb170-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-252"><a href="#cb170-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-253"><a href="#cb170-253" aria-hidden="true" tabindex="-1"></a>Like with every other object type, we can just type in the **dataframe's** name to return it's value, but this tim, let' explore the *structure* of the **dataframe** using the <span class="in">`str()`</span> function.</span>
<span id="cb170-254"><a href="#cb170-254" aria-hidden="true" tabindex="-1"></a>This function can be used on any of the objects we've seen so far, and is particularly helpful when exploring **lists**.</span>
<span id="cb170-255"><a href="#cb170-255" aria-hidden="true" tabindex="-1"></a>One nice feature of **dataframes** is that it will explicitly print the columns types.</span>
<span id="cb170-256"><a href="#cb170-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-259"><a href="#cb170-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-260"><a href="#cb170-260" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(my_dataframe)</span>
<span id="cb170-261"><a href="#cb170-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-262"><a href="#cb170-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-263"><a href="#cb170-263" aria-hidden="true" tabindex="-1"></a><span class="fu">### Matrices</span></span>
<span id="cb170-264"><a href="#cb170-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-265"><a href="#cb170-265" aria-hidden="true" tabindex="-1"></a>**Matrices** are crucial to many scientific fields, including epidemiology, as they are the basis of linear algebra.</span>
<span id="cb170-266"><a href="#cb170-266" aria-hidden="true" tabindex="-1"></a>This course will use **matrix** multiplication extensively (notably <span class="co">[</span><span class="ot">R Session 2</span><span class="co">](r-session-02.qmd)</span>), so it is worth knowing how to create matrices.</span>
<span id="cb170-267"><a href="#cb170-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-268"><a href="#cb170-268" aria-hidden="true" tabindex="-1"></a>Much like vectors, all elements in a **matrix** should be the same type (or they will be coerced if possible, resulting in <span class="in">`NA`</span> if not).</span>
<span id="cb170-269"><a href="#cb170-269" aria-hidden="true" tabindex="-1"></a>It is unusual to have a **non-numeric matrix** e.g., a **character matrix**, but it is possible.</span>
<span id="cb170-270"><a href="#cb170-270" aria-hidden="true" tabindex="-1"></a>When we create our **matrix**, notice that it fills column-first, much like how we think of **matrices** in math (i.e., <span class="in">`i`</span> then <span class="in">`j`</span>).</span>
<span id="cb170-271"><a href="#cb170-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-274"><a href="#cb170-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-275"><a href="#cb170-275" aria-hidden="true" tabindex="-1"></a>my_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb170-276"><a href="#cb170-276" aria-hidden="true" tabindex="-1"></a>my_matrix</span>
<span id="cb170-277"><a href="#cb170-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-278"><a href="#cb170-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-279"><a href="#cb170-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Indexing objects</span></span>
<span id="cb170-280"><a href="#cb170-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### Indexing operators</span></span>
<span id="cb170-281"><a href="#cb170-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-282"><a href="#cb170-282" aria-hidden="true" tabindex="-1"></a>We've got our objects, but now we want to do stuff with them.</span>
<span id="cb170-283"><a href="#cb170-283" aria-hidden="true" tabindex="-1"></a>Without getting into too much detail about *Object-Oriented Programming* (e.g., the <span class="in">`S3`</span> class system in <span class="in">`R`</span>), there are three mains ways of indexing in <span class="in">`R`</span>:</span>
<span id="cb170-284"><a href="#cb170-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-285"><a href="#cb170-285" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The single bracket <span class="in">`[]`</span></span>
<span id="cb170-286"><a href="#cb170-286" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The double bracket <span class="in">`[[]]`</span></span>
<span id="cb170-287"><a href="#cb170-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The dollar sign <span class="in">`$`</span></span>
<span id="cb170-288"><a href="#cb170-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-289"><a href="#cb170-289" aria-hidden="true" tabindex="-1"></a>Which method we use depends on the type of object we have.</span>
<span id="cb170-290"><a href="#cb170-290" aria-hidden="true" tabindex="-1"></a>Handily, <span class="in">`[]`</span> will work for pretty much everything, and we typically only use use <span class="in">`[[]]`</span> for **lists**.</span>
<span id="cb170-291"><a href="#cb170-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-292"><a href="#cb170-292" aria-hidden="true" tabindex="-1"></a><span class="fu">### Indexing vectors</span></span>
<span id="cb170-293"><a href="#cb170-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-294"><a href="#cb170-294" aria-hidden="true" tabindex="-1"></a>With both <span class="in">`[]`</span> and <span class="in">`[[]]`</span>, we can use the *indices* i.e., the numbered position of the specific values/elements we want to extract, but if we have named objects, we can pass the names to the `[]` in a **vector**.</span>
<span id="cb170-295"><a href="#cb170-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-298"><a href="#cb170-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-299"><a href="#cb170-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract elements 1 through 3 inclusively</span></span>
<span id="cb170-300"><a href="#cb170-300" aria-hidden="true" tabindex="-1"></a>my_char_vec[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb170-301"><a href="#cb170-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-302"><a href="#cb170-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the same elements but using their names in a vector</span></span>
<span id="cb170-303"><a href="#cb170-303" aria-hidden="true" tabindex="-1"></a>my_named_char_vec[<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)]</span>
<span id="cb170-304"><a href="#cb170-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-305"><a href="#cb170-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-306"><a href="#cb170-306" aria-hidden="true" tabindex="-1"></a>Notice that when we index the named **vector** we get *both* the name *and* the value returned.</span>
<span id="cb170-307"><a href="#cb170-307" aria-hidden="true" tabindex="-1"></a>Many times this is OK, but if we only wanted the value, then you'd index with <span class="in">`[[]]`</span>, but it is important to note that you can only pass *one* value to the brackets.</span>
<span id="cb170-308"><a href="#cb170-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-311"><a href="#cb170-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-312"><a href="#cb170-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb170-313"><a href="#cb170-313" aria-hidden="true" tabindex="-1"></a>my_named_char_vec[[<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>)]]</span>
<span id="cb170-314"><a href="#cb170-314" aria-hidden="true" tabindex="-1"></a>my_named_char_vec[[<span class="st">"a"</span>]]</span>
<span id="cb170-315"><a href="#cb170-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-316"><a href="#cb170-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-317"><a href="#cb170-317" aria-hidden="true" tabindex="-1"></a>If you're wondering why go through the hassle, it's because values can change position in the list when we update inputs, such as **csv** datafiles, or needing to restructure code to make something else work.</span>
<span id="cb170-318"><a href="#cb170-318" aria-hidden="true" tabindex="-1"></a>If we only index with the numeric indices, we run the risk of a silent error being returned i.e., a value is provided to us, but we don't know that it's referring to the wrong thing.</span>
<span id="cb170-319"><a href="#cb170-319" aria-hidden="true" tabindex="-1"></a>Indexing with names mean that the element's position in the **vector** doesn't matter, and if it's accidentally been removed when we updated code, and error will be explicitly thrown as it won't be able to find the index.</span>
<span id="cb170-320"><a href="#cb170-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-321"><a href="#cb170-321" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lists and Dataframes</span></span>
<span id="cb170-322"><a href="#cb170-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-323"><a href="#cb170-323" aria-hidden="true" tabindex="-1"></a>When it comes to indexing **lists** and **dataframes** (remember, **dataframes** are just special **lists**, so the same methods are available to us), it is more common to use <span class="in">`[[]]`</span> and <span class="in">`$`</span>, though there are obviously occasions when <span class="in">`[]`</span> is useful.</span>
<span id="cb170-324"><a href="#cb170-324" aria-hidden="true" tabindex="-1"></a>Let's look at <span class="in">`my_named_list`</span> first.</span>
<span id="cb170-325"><a href="#cb170-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-328"><a href="#cb170-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-329"><a href="#cb170-329" aria-hidden="true" tabindex="-1"></a>my_named_list[<span class="dv">1</span>]</span>
<span id="cb170-330"><a href="#cb170-330" aria-hidden="true" tabindex="-1"></a>my_named_list[<span class="st">"my_vec"</span>]</span>
<span id="cb170-331"><a href="#cb170-331" aria-hidden="true" tabindex="-1"></a>my_named_list[[<span class="dv">1</span>]]</span>
<span id="cb170-332"><a href="#cb170-332" aria-hidden="true" tabindex="-1"></a>my_named_list[[<span class="st">"my_vec"</span>]]</span>
<span id="cb170-333"><a href="#cb170-333" aria-hidden="true" tabindex="-1"></a>my_named_list<span class="sc">$</span>my_vec</span>
<span id="cb170-334"><a href="#cb170-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-335"><a href="#cb170-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-336"><a href="#cb170-336" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb170-337"><a href="#cb170-337" aria-hidden="true" tabindex="-1"></a>In the examples above, notice how both <span class="in">`[]`</span> methods returned the name of the element as well as the values (as it did before with the named **vector**).</span>
<span id="cb170-338"><a href="#cb170-338" aria-hidden="true" tabindex="-1"></a>This is important as it means we need to extract the values from what is returned before we can do any further indexing i.e., to get the value <span class="in">`3`</span> from the **list** element <span class="in">`my_vec`</span>.</span>
<span id="cb170-339"><a href="#cb170-339" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-340"><a href="#cb170-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-341"><a href="#cb170-341" aria-hidden="true" tabindex="-1"></a>We can do the same with the unnamed **list**, except the last two methods are not available as we do not have a name to use.</span>
<span id="cb170-342"><a href="#cb170-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-345"><a href="#cb170-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-346"><a href="#cb170-346" aria-hidden="true" tabindex="-1"></a>my_list[<span class="dv">1</span>]</span>
<span id="cb170-347"><a href="#cb170-347" aria-hidden="true" tabindex="-1"></a>my_list[[<span class="dv">1</span>]]</span>
<span id="cb170-348"><a href="#cb170-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-349"><a href="#cb170-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-350"><a href="#cb170-350" aria-hidden="true" tabindex="-1"></a>Because a **dataframe** is a type of list where the column headers are the element names, we can use <span class="in">`[[]]`</span> and <span class="in">`$`</span> as with the named list.</span>
<span id="cb170-351"><a href="#cb170-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-354"><a href="#cb170-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-355"><a href="#cb170-355" aria-hidden="true" tabindex="-1"></a>my_dataframe[<span class="dv">1</span>]</span>
<span id="cb170-356"><a href="#cb170-356" aria-hidden="true" tabindex="-1"></a>my_dataframe[[<span class="dv">1</span>]]</span>
<span id="cb170-357"><a href="#cb170-357" aria-hidden="true" tabindex="-1"></a>my_dataframe[<span class="st">"column_int"</span>]</span>
<span id="cb170-358"><a href="#cb170-358" aria-hidden="true" tabindex="-1"></a>my_dataframe<span class="sc">$</span>column_int</span>
<span id="cb170-359"><a href="#cb170-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-360"><a href="#cb170-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-361"><a href="#cb170-361" aria-hidden="true" tabindex="-1"></a>If we wanted to extract a particular value from a column, we can use the following methods.</span>
<span id="cb170-362"><a href="#cb170-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-365"><a href="#cb170-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-366"><a href="#cb170-366" aria-hidden="true" tabindex="-1"></a><span class="co"># indexes i then j, just like in math</span></span>
<span id="cb170-367"><a href="#cb170-367" aria-hidden="true" tabindex="-1"></a>my_dataframe[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb170-368"><a href="#cb170-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-369"><a href="#cb170-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the second element from the first column</span></span>
<span id="cb170-370"><a href="#cb170-370" aria-hidden="true" tabindex="-1"></a>my_dataframe[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb170-371"><a href="#cb170-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-372"><a href="#cb170-372" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the second element from column_int, using the i, j procedure as before</span></span>
<span id="cb170-373"><a href="#cb170-373" aria-hidden="true" tabindex="-1"></a>my_dataframe[<span class="dv">2</span>, <span class="st">"column_int"</span>]</span>
<span id="cb170-374"><a href="#cb170-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-375"><a href="#cb170-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the second element from column_int</span></span>
<span id="cb170-376"><a href="#cb170-376" aria-hidden="true" tabindex="-1"></a>my_dataframe<span class="sc">$</span>column_int[<span class="dv">2</span>]</span>
<span id="cb170-377"><a href="#cb170-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-378"><a href="#cb170-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-379"><a href="#cb170-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-380"><a href="#cb170-380" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages</span></span>
<span id="cb170-381"><a href="#cb170-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-382"><a href="#cb170-382" aria-hidden="true" tabindex="-1"></a>Up until now, we've been getting to grips with the core concepts of objects, and indexing them.</span>
<span id="cb170-383"><a href="#cb170-383" aria-hidden="true" tabindex="-1"></a>But when you're writing code, you'll want to do things that are relatively complicated to implement, such as solve a set of differential equations.</span>
<span id="cb170-384"><a href="#cb170-384" aria-hidden="true" tabindex="-1"></a>Fortunately, for many areas of computing (and, indeed, epidemiology and statistics), many others have also struggled with the same issues and some have gone one to document their solutions in a way others can re-use them.</span>
<span id="cb170-385"><a href="#cb170-385" aria-hidden="true" tabindex="-1"></a>This is the basis for **packages**.</span>
<span id="cb170-386"><a href="#cb170-386" aria-hidden="true" tabindex="-1"></a>Someone has *packaged up* a set of functions for others to re-use.</span>
<span id="cb170-387"><a href="#cb170-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-388"><a href="#cb170-388" aria-hidden="true" tabindex="-1"></a>We've mentioned the word **function** a number of time so far, and we haven't defined it, but that's <span class="co">[</span><span class="ot">coming soon</span><span class="co">](#functions)</span>.</span>
<span id="cb170-389"><a href="#cb170-389" aria-hidden="true" tabindex="-1"></a>For the moment, let's just look at how we can find, install, and load **packages**.</span>
<span id="cb170-390"><a href="#cb170-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-391"><a href="#cb170-391" aria-hidden="true" tabindex="-1"></a><span class="fu">### Finding packages</span></span>
<span id="cb170-392"><a href="#cb170-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-393"><a href="#cb170-393" aria-hidden="true" tabindex="-1"></a>As <span class="co">[</span><span class="ot">mentioned previously</span><span class="co">](install-r.qmd#r)</span> CRAN is a place where many pieces of <span class="in">`R`</span> code is documents and stored for others to download and use.</span>
<span id="cb170-394"><a href="#cb170-394" aria-hidden="true" tabindex="-1"></a>Not only are the <span class="in">`R`</span> programming language executables stored in CRAN, but so are user-defined **functions** that have been turned into **packages**.</span>
<span id="cb170-395"><a href="#cb170-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-396"><a href="#cb170-396" aria-hidden="true" tabindex="-1"></a>To find packages, you can go to the CRAN website and search by name, but there are far too many for that to be worthwhile - just Google what you want to do and add "r" to the end of your search query, and you'll likely find what you're looking for.</span>
<span id="cb170-397"><a href="#cb170-397" aria-hidden="true" tabindex="-1"></a>Once you've found a package you want to download, next you need to install it.</span>
<span id="cb170-398"><a href="#cb170-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-399"><a href="#cb170-399" aria-hidden="true" tabindex="-1"></a><span class="fu">### Installing packages</span></span>
<span id="cb170-400"><a href="#cb170-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-401"><a href="#cb170-401" aria-hidden="true" tabindex="-1"></a>Barring any super-niche packages, you should be able to use the following command(s):</span>
<span id="cb170-402"><a href="#cb170-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-405"><a href="#cb170-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-406"><a href="#cb170-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb170-407"><a href="#cb170-407" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"package to download"</span>)</span>
<span id="cb170-408"><a href="#cb170-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Download multiple by passing a vector of package names</span></span>
<span id="cb170-409"><a href="#cb170-409" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"package 1"</span>, <span class="st">"package 2"</span>))</span>
<span id="cb170-410"><a href="#cb170-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-411"><a href="#cb170-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-412"><a href="#cb170-412" aria-hidden="true" tabindex="-1"></a>If for some reason you get an error message saying the package isn't available on CRAN, first, check for typos, and if you still get an error, you may need to download it directly from GitHub.</span>
<span id="cb170-413"><a href="#cb170-413" aria-hidden="true" tabindex="-1"></a>Read <span class="co">[</span><span class="ot">here</span><span class="co">](https://pak.r-lib.org/dev/reference/get-started.html#install-a-package-from-github)</span> for more information about using the <span class="in">`{pak}`</span> package to download packages from other sources.</span>
<span id="cb170-414"><a href="#cb170-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-415"><a href="#cb170-415" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading packages</span></span>
<span id="cb170-416"><a href="#cb170-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-417"><a href="#cb170-417" aria-hidden="true" tabindex="-1"></a>Now you have your packages installed, you just need to load them to get any of their functionality.</span>
<span id="cb170-418"><a href="#cb170-418" aria-hidden="true" tabindex="-1"></a>The easiest way is to place this code at the top of your script.</span>
<span id="cb170-419"><a href="#cb170-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-422"><a href="#cb170-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-423"><a href="#cb170-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb170-424"><a href="#cb170-424" aria-hidden="true" tabindex="-1"></a><span class="co"># Quotations are not required, but can be used</span></span>
<span id="cb170-425"><a href="#cb170-425" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(package to download)</span>
<span id="cb170-426"><a href="#cb170-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-427"><a href="#cb170-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-428"><a href="#cb170-428" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">id</span><span class="ot">=</span><span class="st">"namespace-conflict"</span><span class="kw">/&gt;</span></span>
<span id="cb170-429"><a href="#cb170-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-430"><a href="#cb170-430" aria-hidden="true" tabindex="-1"></a>Most of the time, this is fine, but occasionally you will run in to an issue where a function doesn't work as expected.</span>
<span id="cb170-431"><a href="#cb170-431" aria-hidden="true" tabindex="-1"></a>Sometimes this is because of what's called a *namespace conflict* i.e., you have two functions with the same name loaded, and potentially you're using the wrong verion.</span>
<span id="cb170-432"><a href="#cb170-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-433"><a href="#cb170-433" aria-hidden="true" tabindex="-1"></a>For example, in base <span class="in">`R`</span> (i.e, these functions come pre-installed when you set up <span class="in">`R`</span>), there is a <span class="in">`filter()`</span> function from the <span class="in">`{stats}`</span> package (as mentioned, we'll denote this as <span class="in">`stats::filter()`</span>).</span>
<span id="cb170-434"><a href="#cb170-434" aria-hidden="true" tabindex="-1"></a>Throughout this workshop, you will see <span class="in">`library(tidyverse)`</span> at the top of the pages to indicate the <span class="in">`{tidyverse}`</span> set of packages are being loaded (this is actually a package that installs a bunch of related and useful packages for us).</span>
<span id="cb170-435"><a href="#cb170-435" aria-hidden="true" tabindex="-1"></a>In <span class="in">`{dplyr}`</span> (one of the packages loaded by <span class="in">`{tidyverse}`</span>) there is also a function called <span class="in">`filter()`</span>.</span>
<span id="cb170-436"><a href="#cb170-436" aria-hidden="true" tabindex="-1"></a>Because <span class="in">`{dplyr}`</span> was loaded after <span class="in">`{stats}`</span> was loaded (because <span class="in">`{stats}`</span> is automatically loaded when <span class="in">`R`</span> is started), the <span class="in">`dplyr::filter()`</span> function will take precedence.</span>
<span id="cb170-437"><a href="#cb170-437" aria-hidden="true" tabindex="-1"></a>If we wanted to specifically use the <span class="in">`{stats}`</span> version, we could write this:</span>
<span id="cb170-438"><a href="#cb170-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-441"><a href="#cb170-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-442"><a href="#cb170-442" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a cosine wave with random noise</span></span>
<span id="cb170-443"><a href="#cb170-443" aria-hidden="true" tabindex="-1"></a>raw_timeseries <span class="ot">&lt;-</span> <span class="fu">cos</span>(pi <span class="sc">*</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb170-444"><a href="#cb170-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-445"><a href="#cb170-445" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 20 day moving average using stats::filter()</span></span>
<span id="cb170-446"><a href="#cb170-446" aria-hidden="true" tabindex="-1"></a>smooth_timeseries <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">filter</span>(raw_timeseries, <span class="at">filter =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="dv">20</span>), <span class="at">sides =</span> <span class="dv">1</span>)</span>
<span id="cb170-447"><a href="#cb170-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-448"><a href="#cb170-448" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot raw data</span></span>
<span id="cb170-449"><a href="#cb170-449" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raw_timeseries, <span class="at">col =</span> <span class="st">"grey80"</span>)</span>
<span id="cb170-450"><a href="#cb170-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-451"><a href="#cb170-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay smoothed data</span></span>
<span id="cb170-452"><a href="#cb170-452" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(smooth_timeseries, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb170-453"><a href="#cb170-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-454"><a href="#cb170-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-455"><a href="#cb170-455" aria-hidden="true" tabindex="-1"></a><span class="fu">## Functions</span></span>
<span id="cb170-456"><a href="#cb170-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-457"><a href="#cb170-457" aria-hidden="true" tabindex="-1"></a>As we've alluded to, **functions** are core to gaining *functionality* in <span class="in">`R`</span>.</span>
<span id="cb170-458"><a href="#cb170-458" aria-hidden="true" tabindex="-1"></a>We can always hand-write the code to complete a task, but if we have to repeat a task more than once, it can be tiresome to repeat the same code, particularly if it is a particularly complex task that requires many lines of code.</span>
<span id="cb170-459"><a href="#cb170-459" aria-hidden="true" tabindex="-1"></a>This is where **functions** come in: they provide us with a mechanism to wrap up code into something that can be re-used.</span>
<span id="cb170-460"><a href="#cb170-460" aria-hidden="true" tabindex="-1"></a>Not only does this reduce the amount of code we need to write, but by minimize code duplication, debugging becomes a lot easier as we only need to remember to make changes and correct one section of our codebase.</span>
<span id="cb170-461"><a href="#cb170-461" aria-hidden="true" tabindex="-1"></a>Say, for example, you want to take a vector of numbers and calculate the cumulative sum e.g.; </span>
<span id="cb170-462"><a href="#cb170-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-465"><a href="#cb170-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-466"><a href="#cb170-466" aria-hidden="true" tabindex="-1"></a>my_dbl_vec <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb170-467"><a href="#cb170-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-468"><a href="#cb170-468" aria-hidden="true" tabindex="-1"></a>cumulative_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb170-469"><a href="#cb170-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-470"><a href="#cb170-470" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(my_dbl_vec)) {</span>
<span id="cb170-471"><a href="#cb170-471" aria-hidden="true" tabindex="-1"></a>    cumulative_sum <span class="ot">&lt;-</span> cumulative_sum <span class="sc">+</span> i</span>
<span id="cb170-472"><a href="#cb170-472" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-473"><a href="#cb170-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-474"><a href="#cb170-474" aria-hidden="true" tabindex="-1"></a>cumulative_sum</span>
<span id="cb170-475"><a href="#cb170-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-476"><a href="#cb170-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-477"><a href="#cb170-477" aria-hidden="true" tabindex="-1"></a>This is OK if we only do this calculation once, but it's easy to imagine us wanting to repeat this calculation; for example, we might use calculate the cumulative sum of daily cases to get a weekly incidence over every week of a year.</span>
<span id="cb170-478"><a href="#cb170-478" aria-hidden="true" tabindex="-1"></a>In this situation, we would want to create a function.</span>
<span id="cb170-479"><a href="#cb170-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-482"><a href="#cb170-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-483"><a href="#cb170-483" aria-hidden="true" tabindex="-1"></a>my_cumsum <span class="ot">&lt;-</span> <span class="cf">function</span>(vector) {</span>
<span id="cb170-484"><a href="#cb170-484" aria-hidden="true" tabindex="-1"></a>    cumulative_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb170-485"><a href="#cb170-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-486"><a href="#cb170-486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(my_dbl_vec)) {</span>
<span id="cb170-487"><a href="#cb170-487" aria-hidden="true" tabindex="-1"></a>        cumulative_sum <span class="ot">&lt;-</span> cumulative_sum <span class="sc">+</span> i</span>
<span id="cb170-488"><a href="#cb170-488" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-489"><a href="#cb170-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-490"><a href="#cb170-490" aria-hidden="true" tabindex="-1"></a>    cumulative_sum</span>
<span id="cb170-491"><a href="#cb170-491" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-492"><a href="#cb170-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-493"><a href="#cb170-493" aria-hidden="true" tabindex="-1"></a><span class="fu">my_cumsum</span>(my_dbl_vec)</span>
<span id="cb170-494"><a href="#cb170-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-495"><a href="#cb170-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-496"><a href="#cb170-496" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-497"><a href="#cb170-497" aria-hidden="true" tabindex="-1"></a>This is obviously a contrived example because, as with many basic operations in <span class="in">`R`</span>, there is already a function written to perform this calculation that does it in a much more performant and safer manner: <span class="in">`cumsum()`</span></span>
<span id="cb170-498"><a href="#cb170-498" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-499"><a href="#cb170-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-500"><a href="#cb170-500" aria-hidden="true" tabindex="-1"></a>For many of the manipulations we will want to perform, a **function** has already been written by someone else and put into a **package** that we can download, as we've <span class="co">[</span><span class="ot">already seen</span><span class="co">](#packages)</span>.</span>
<span id="cb170-501"><a href="#cb170-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-502"><a href="#cb170-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Anonymous functions</span></span>
<span id="cb170-503"><a href="#cb170-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-504"><a href="#cb170-504" aria-hidden="true" tabindex="-1"></a>There is a special class of functions called anonymous functions that are worth being aware of, as we will use them quite extensively throughout this workshop.</span>
<span id="cb170-505"><a href="#cb170-505" aria-hidden="true" tabindex="-1"></a>As the name might suggest, **anonymous functions** are functions that are not named, and therefore, not saved for re-use.</span>
<span id="cb170-506"><a href="#cb170-506" aria-hidden="true" tabindex="-1"></a>You may, understandably, be wondering why we would want to use them, given we just make the case for functions replacing repeatable blocks of code.</span>
<span id="cb170-507"><a href="#cb170-507" aria-hidden="true" tabindex="-1"></a>In some instances, we want to be able to perform multiple computations that require creating intermediate objects, but because we only need to use them once, we don't save them save to our environment, potentially causing issues with conflicts (e.g., accidentally using an object we didn't mean to, or overwriting existing ones by re-using the same object name).</span>
<span id="cb170-508"><a href="#cb170-508" aria-hidden="true" tabindex="-1"></a>This gets into the broader concept of local vs global scopes, but that is too far beyond the scope of this workshop: see <span class="co">[</span><span class="ot">Hands-On Programming with R</span><span class="co">](https://rstudio-education.github.io/hopr/environments.html#scoping-rules)</span> and <span class="co">[</span><span class="ot">Advanced R</span><span class="co">](https://adv-r.hadley.nz/functions.html?q=lexical#lexical-scoping)</span> for more information.</span>
<span id="cb170-509"><a href="#cb170-509" aria-hidden="true" tabindex="-1"></a>Let's look at an example to see when we might want to use an anonymous function.</span>
<span id="cb170-510"><a href="#cb170-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-511"><a href="#cb170-511" aria-hidden="true" tabindex="-1"></a>Throughout this workshop, we will make use of the <span class="in">`map_*()`</span> series of functions from the <span class="in">`{purrr}`</span> package.</span>
<span id="cb170-512"><a href="#cb170-512" aria-hidden="true" tabindex="-1"></a>We'll go into more detail about <span class="in">`purr::map()`</span> <span class="co">[</span><span class="ot">shortly</span><span class="co">](#sec-map-functions)</span>, but for now, imagine we have a **vector** of numbers, and we want to add <span class="in">`5`</span> to each value before and multiplying by <span class="in">`10`</span>.</span>
<span id="cb170-513"><a href="#cb170-513" aria-hidden="true" tabindex="-1"></a>The <span class="in">`map_dbl()`</span> function takes a **vector** and a function, and outputs a **double vector**.</span>
<span id="cb170-514"><a href="#cb170-514" aria-hidden="true" tabindex="-1"></a>We could write a function to perform this multiplication, but if we're only going to do this operation once, it seems unnecessary.</span>
<span id="cb170-515"><a href="#cb170-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-518"><a href="#cb170-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-519"><a href="#cb170-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb170-520"><a href="#cb170-520" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map_dbl</span>(</span>
<span id="cb170-521"><a href="#cb170-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> my_dbl_vec,</span>
<span id="cb170-522"><a href="#cb170-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="cf">function</span>(.x) {</span>
<span id="cb170-523"><a href="#cb170-523" aria-hidden="true" tabindex="-1"></a>        add_five_val <span class="ot">&lt;-</span> .x <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb170-524"><a href="#cb170-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-525"><a href="#cb170-525" aria-hidden="true" tabindex="-1"></a>        add_five_val <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb170-526"><a href="#cb170-526" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-527"><a href="#cb170-527" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-528"><a href="#cb170-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-529"><a href="#cb170-529" aria-hidden="true" tabindex="-1"></a><span class="co"># only exists within the function</span></span>
<span id="cb170-530"><a href="#cb170-530" aria-hidden="true" tabindex="-1"></a>add_five_val</span>
<span id="cb170-531"><a href="#cb170-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-532"><a href="#cb170-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-533"><a href="#cb170-533" aria-hidden="true" tabindex="-1"></a>Here, we've specified the anonymous function to take the input <span class="in">`.x`</span> and multiple each value by 10, and we did it without saving the function.</span>
<span id="cb170-534"><a href="#cb170-534" aria-hidden="true" tabindex="-1"></a>This would be equivalent to writing this:</span>
<span id="cb170-535"><a href="#cb170-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-538"><a href="#cb170-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-539"><a href="#cb170-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb170-540"><a href="#cb170-540" aria-hidden="true" tabindex="-1"></a>add_five_multiply_ten <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb170-541"><a href="#cb170-541" aria-hidden="true" tabindex="-1"></a>    add_five_val <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb170-542"><a href="#cb170-542" aria-hidden="true" tabindex="-1"></a>    add_five_val <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb170-543"><a href="#cb170-543" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-544"><a href="#cb170-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-545"><a href="#cb170-545" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map_dbl</span>(</span>
<span id="cb170-546"><a href="#cb170-546" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> my_dbl_vec,</span>
<span id="cb170-547"><a href="#cb170-547" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">add_five_multiply_ten</span>(.x)</span>
<span id="cb170-548"><a href="#cb170-548" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-549"><a href="#cb170-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-550"><a href="#cb170-550" aria-hidden="true" tabindex="-1"></a><span class="co"># only exists within the function</span></span>
<span id="cb170-551"><a href="#cb170-551" aria-hidden="true" tabindex="-1"></a>add_five_val</span>
<span id="cb170-552"><a href="#cb170-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-553"><a href="#cb170-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-554"><a href="#cb170-554" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb170-555"><a href="#cb170-555" aria-hidden="true" tabindex="-1"></a>Notice the <span class="in">`~`</span> used: this specifies that we want to pass arguments into our named function.</span>
<span id="cb170-556"><a href="#cb170-556" aria-hidden="true" tabindex="-1"></a>Without it, we will get an error about <span class="in">`.x`</span> not being found.</span>
<span id="cb170-557"><a href="#cb170-557" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-558"><a href="#cb170-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-559"><a href="#cb170-559" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-560"><a href="#cb170-560" aria-hidden="true" tabindex="-1"></a>In this example, because we are doing standard arithmetic, <span class="in">`R`</span> will **vectorize** our function so that it can automatically be applied to each element of the object, so this example was merely to illustrate the point.</span>
<span id="cb170-561"><a href="#cb170-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-564"><a href="#cb170-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-565"><a href="#cb170-565" aria-hidden="true" tabindex="-1"></a><span class="fu">add_five_multiply_ten</span>(my_dbl_vec)</span>
<span id="cb170-566"><a href="#cb170-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-567"><a href="#cb170-567" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-568"><a href="#cb170-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-569"><a href="#cb170-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-570"><a href="#cb170-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tidy data</span></span>
<span id="cb170-571"><a href="#cb170-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-572"><a href="#cb170-572" aria-hidden="true" tabindex="-1"></a>Before we look at the common packages and functions we use throughout this workshop, let's take a second to talk about how our data is structured.</span>
<span id="cb170-573"><a href="#cb170-573" aria-hidden="true" tabindex="-1"></a>For much of what we do, it is convenient to work with **dataframes**, and many functions we will use are designed to work with *long* **dataframes**.</span>
<span id="cb170-574"><a href="#cb170-574" aria-hidden="true" tabindex="-1"></a>What this means is that each *column* represents a variable, and each row is a unique observation.</span>
<span id="cb170-575"><a href="#cb170-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-576"><a href="#cb170-576" aria-hidden="true" tabindex="-1"></a>Let's first look at a **wide dataframe** to see how data may be represented.</span>
<span id="cb170-577"><a href="#cb170-577" aria-hidden="true" tabindex="-1"></a>Here, we have one column representing a number for each of the states in the US, and then we have two columns representing some random incidence: one for July and one for August.</span>
<span id="cb170-578"><a href="#cb170-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-581"><a href="#cb170-581" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-582"><a href="#cb170-582" aria-hidden="true" tabindex="-1"></a>wide_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb170-583"><a href="#cb170-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>,</span>
<span id="cb170-584"><a href="#cb170-584" aria-hidden="true" tabindex="-1"></a>    <span class="at">july_inc =</span> <span class="fu">rbinom</span>(<span class="dv">52</span>, <span class="dv">1000</span>, <span class="fl">0.4</span>),</span>
<span id="cb170-585"><a href="#cb170-585" aria-hidden="true" tabindex="-1"></a>    <span class="at">aug_inc =</span> <span class="fu">rbinom</span>(<span class="dv">52</span>, <span class="dv">1000</span>, <span class="fl">0.6</span>)</span>
<span id="cb170-586"><a href="#cb170-586" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-587"><a href="#cb170-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-588"><a href="#cb170-588" aria-hidden="true" tabindex="-1"></a>wide_df</span>
<span id="cb170-589"><a href="#cb170-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-590"><a href="#cb170-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-591"><a href="#cb170-591" aria-hidden="true" tabindex="-1"></a>Instead, we reshape this into a **long dataframe** so that there is a column for the state ID, a column for the month, and a column for the incidence (that is associated with *both* the state *and* the month).</span>
<span id="cb170-592"><a href="#cb170-592" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`{tidyr}`</span> package, we could reshape this **wide dataframe** to be a **long dataframe** (see <span class="co">[</span><span class="ot">this section</span><span class="co">](#sec-pivot-functions)</span> for more information about the <span class="in">`pivot_*()`</span> functions)</span>
<span id="cb170-593"><a href="#cb170-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-596"><a href="#cb170-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-597"><a href="#cb170-597" aria-hidden="true" tabindex="-1"></a>long_df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb170-598"><a href="#cb170-598" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-599"><a href="#cb170-599" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(july_inc, aug_inc),</span>
<span id="cb170-600"><a href="#cb170-600" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"month"</span>,</span>
<span id="cb170-601"><a href="#cb170-601" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"incidence"</span>,</span>
<span id="cb170-602"><a href="#cb170-602" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract only the month using regex</span></span>
<span id="cb170-603"><a href="#cb170-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">"(.*)_inc"</span></span>
<span id="cb170-604"><a href="#cb170-604" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-605"><a href="#cb170-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-606"><a href="#cb170-606" aria-hidden="true" tabindex="-1"></a>long_df</span>
<span id="cb170-607"><a href="#cb170-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-608"><a href="#cb170-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-609"><a href="#cb170-609" aria-hidden="true" tabindex="-1"></a>You will notice that our new dataframe contains three columns still, but is longer than previously; two time as long, in fact.</span>
<span id="cb170-610"><a href="#cb170-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-611"><a href="#cb170-611" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-612"><a href="#cb170-612" aria-hidden="true" tabindex="-1"></a>Particularly keen-eyed reader may also notice that <span class="in">`long_df`</span> is also has class **tibble**, not a **data.frame**.</span>
<span id="cb170-613"><a href="#cb170-613" aria-hidden="true" tabindex="-1"></a>A **tibble** effectively is a **data.frame**, but is an object commonly used and output by `{tidyverse}` functions, as it has a few extra safety features over the base **data.frame**.</span>
<span id="cb170-614"><a href="#cb170-614" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-615"><a href="#cb170-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-616"><a href="#cb170-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-617"><a href="#cb170-617" aria-hidden="true" tabindex="-1"></a><span class="fu">## Core code used</span></span>
<span id="cb170-618"><a href="#cb170-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-619"><a href="#cb170-619" aria-hidden="true" tabindex="-1"></a>We're finally ready to talk about the functions that are used throughout this workshop.</span>
<span id="cb170-620"><a href="#cb170-620" aria-hidden="true" tabindex="-1"></a>The first package to mention is the <span class="in">`{tidyverse}`</span> package, which actually a collection of packages: the core packages can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.tidyverse.org/packages/)</span>.</span>
<span id="cb170-621"><a href="#cb170-621" aria-hidden="true" tabindex="-1"></a>The reason why are using the <span class="in">`{tidyverse}`</span> packages throughout this workshop is that they are relatively easily to learn, compared to base <span class="in">`R`</span> and <span class="in">`{data.table}`</span> (not that they are mutually exclusive), and what most people are familiar with.</span>
<span id="cb170-622"><a href="#cb170-622" aria-hidden="true" tabindex="-1"></a>They also are well designed and powerful, so you should be able to do most things you need using their packages.</span>
<span id="cb170-623"><a href="#cb170-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-624"><a href="#cb170-624" aria-hidden="true" tabindex="-1"></a>You can find a list of cheatsheets for all of these packages (and more) <span class="co">[</span><span class="ot">here</span><span class="co">](https://posit.co/resources/cheatsheets/?type=posit-cheatsheets&amp;_page=1/)</span>.</span>
<span id="cb170-625"><a href="#cb170-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-626"><a href="#cb170-626" aria-hidden="true" tabindex="-1"></a>Let's load the <span class="in">`{tidyverse}`</span> packages and then go through the key functions used.</span>
<span id="cb170-627"><a href="#cb170-627" aria-hidden="true" tabindex="-1"></a>Unless stated explicitly, these packages will be available to you after loading the <span class="in">`{tidyverse}`</span> with the following command.</span>
<span id="cb170-628"><a href="#cb170-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-631"><a href="#cb170-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-632"><a href="#cb170-632" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb170-633"><a href="#cb170-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-634"><a href="#cb170-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-635"><a href="#cb170-635" aria-hidden="true" tabindex="-1"></a><span class="fu">### `tibble()`</span></span>
<span id="cb170-636"><a href="#cb170-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-637"><a href="#cb170-637" aria-hidden="true" tabindex="-1"></a>The **tibble** is a modern reincarnation of the **dataframes** that is slightly safer i.e., is more restricted in what you can do with it, and will throw errrors more frequently, but very rarely for anything other than a bug.</span>
<span id="cb170-638"><a href="#cb170-638" aria-hidden="true" tabindex="-1"></a>We will use the terms interchangeably, as most people will just talk about **dataframes**, as for the most part, they can be treated identically.</span>
<span id="cb170-639"><a href="#cb170-639" aria-hidden="true" tabindex="-1"></a>Use the same syntax as the <span class="in">`data.frame()`</span> function to create the **tibble**.</span>
<span id="cb170-640"><a href="#cb170-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-641"><a href="#cb170-641" aria-hidden="true" tabindex="-1"></a><span class="fu">### `dplyr::filter()`</span></span>
<span id="cb170-642"><a href="#cb170-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-643"><a href="#cb170-643" aria-hidden="true" tabindex="-1"></a>If we wanted to take a subset of rows of a **dataframe**, we would use the <span class="in">`dplyr::filter()`</span> function.</span>
<span id="cb170-644"><a href="#cb170-644" aria-hidden="true" tabindex="-1"></a>Here, we're listing the package it's coming from, as there are some other packages that also export their own version of the <span class="in">`filter()`</span> function.</span>
<span id="cb170-645"><a href="#cb170-645" aria-hidden="true" tabindex="-1"></a>However, for all the code in this workshop, there aren't any concerns about <span class="co">[</span><span class="ot">**namespace conflicts**</span><span class="co">](#namespace-conflict)</span>, so we won't use it from here on in.</span>
<span id="cb170-646"><a href="#cb170-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-647"><a href="#cb170-647" aria-hidden="true" tabindex="-1"></a>The <span class="in">`filter()`</span> function is relatively simple to work with: you specify the **dataframe** variable you want to subset by, the filtering criteria, and that's it.</span>
<span id="cb170-648"><a href="#cb170-648" aria-hidden="true" tabindex="-1"></a>If we include multiple arguments, they get treated as *AND* statements (<span class="in">`&amp;`</span>), so all conditions need to be met.</span>
<span id="cb170-649"><a href="#cb170-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-652"><a href="#cb170-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-653"><a href="#cb170-653" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(</span>
<span id="cb170-654"><a href="#cb170-654" aria-hidden="true" tabindex="-1"></a>    long_df,</span>
<span id="cb170-655"><a href="#cb170-655" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="st">"july"</span>,</span>
<span id="cb170-656"><a href="#cb170-656" aria-hidden="true" tabindex="-1"></a>    incidence <span class="sc">&gt;</span> <span class="dv">410</span></span>
<span id="cb170-657"><a href="#cb170-657" aria-hidden="true" tabindex="-1"></a>    <span class="co"># equivalent to: month == "july" &amp; incidence &gt; 410</span></span>
<span id="cb170-658"><a href="#cb170-658" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-659"><a href="#cb170-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-660"><a href="#cb170-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-661"><a href="#cb170-661" aria-hidden="true" tabindex="-1"></a>We can filter using **OR** statements (<span class="in">`|`</span>), so if either condition returns <span class="in">`TRUE`</span>, then it will be included in the subset.</span>
<span id="cb170-662"><a href="#cb170-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-665"><a href="#cb170-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-666"><a href="#cb170-666" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(</span>
<span id="cb170-667"><a href="#cb170-667" aria-hidden="true" tabindex="-1"></a>    long_df,</span>
<span id="cb170-668"><a href="#cb170-668" aria-hidden="true" tabindex="-1"></a>    month <span class="sc">==</span> <span class="st">"july"</span> <span class="sc">|</span> incidence <span class="sc">&gt;</span> <span class="dv">600</span></span>
<span id="cb170-669"><a href="#cb170-669" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-670"><a href="#cb170-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-671"><a href="#cb170-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-672"><a href="#cb170-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-673"><a href="#cb170-673" aria-hidden="true" tabindex="-1"></a><span class="fu">### `select()`</span></span>
<span id="cb170-674"><a href="#cb170-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-675"><a href="#cb170-675" aria-hidden="true" tabindex="-1"></a>If, instead, we wanted to subset of columns of a **dataframe**, we would use the <span class="in">`dplyr::select()`</span> function.</span>
<span id="cb170-676"><a href="#cb170-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-677"><a href="#cb170-677" aria-hidden="true" tabindex="-1"></a>Let's say, from our wide incidence data, we only want the state's ID and their August incidence.</span>
<span id="cb170-678"><a href="#cb170-678" aria-hidden="true" tabindex="-1"></a>We can directly select the columns this way.</span>
<span id="cb170-679"><a href="#cb170-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-682"><a href="#cb170-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-683"><a href="#cb170-683" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(</span>
<span id="cb170-684"><a href="#cb170-684" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-685"><a href="#cb170-685" aria-hidden="true" tabindex="-1"></a>    state_id, aug_inc</span>
<span id="cb170-686"><a href="#cb170-686" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-687"><a href="#cb170-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-688"><a href="#cb170-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-689"><a href="#cb170-689" aria-hidden="true" tabindex="-1"></a>But in this case, it would be more efficient (for us) to tell <span class="in">`R`</span> the columns we *don't* want.</span>
<span id="cb170-690"><a href="#cb170-690" aria-hidden="true" tabindex="-1"></a>We can do that using the <span class="in">`-`</span> sign.</span>
<span id="cb170-691"><a href="#cb170-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-694"><a href="#cb170-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-695"><a href="#cb170-695" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(</span>
<span id="cb170-696"><a href="#cb170-696" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-697"><a href="#cb170-697" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>july_inc</span>
<span id="cb170-698"><a href="#cb170-698" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-699"><a href="#cb170-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-700"><a href="#cb170-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-701"><a href="#cb170-701" aria-hidden="true" tabindex="-1"></a>If there were multiple columns we didn't want, we would pass them in a vector.</span>
<span id="cb170-702"><a href="#cb170-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-705"><a href="#cb170-705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-706"><a href="#cb170-706" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(</span>
<span id="cb170-707"><a href="#cb170-707" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-708"><a href="#cb170-708" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">c</span>(july_inc, aug_inc)</span>
<span id="cb170-709"><a href="#cb170-709" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-710"><a href="#cb170-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-711"><a href="#cb170-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-712"><a href="#cb170-712" aria-hidden="true" tabindex="-1"></a>When it comes to selecting columns, the <span class="in">`{tidyselect}`</span> package has a few very handy functions for us.</span>
<span id="cb170-713"><a href="#cb170-713" aria-hidden="true" tabindex="-1"></a>To understand when they are most useful, let's first look at the <span class="in">`mutate()`</span> function, and then we'll highlight how to use the different column selection functions available to use through <span class="in">`{tidyselect}`</span>.</span>
<span id="cb170-714"><a href="#cb170-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-715"><a href="#cb170-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### `mutate()`</span></span>
<span id="cb170-716"><a href="#cb170-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-717"><a href="#cb170-717" aria-hidden="true" tabindex="-1"></a>If we have a **dataframe** and want to add or edit a column, we use the <span class="in">`mutate()`</span> function.</span>
<span id="cb170-718"><a href="#cb170-718" aria-hidden="true" tabindex="-1"></a>Usually the <span class="in">`mutate()`</span> function is used to add a column that is related to the existing data, but it is not necessary.</span>
<span id="cb170-719"><a href="#cb170-719" aria-hidden="true" tabindex="-1"></a>Below are examples of both.</span>
<span id="cb170-720"><a href="#cb170-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-723"><a href="#cb170-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-724"><a href="#cb170-724" aria-hidden="true" tabindex="-1"></a><span class="co"># add September incidence that is based on August incidence</span></span>
<span id="cb170-725"><a href="#cb170-725" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-726"><a href="#cb170-726" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-727"><a href="#cb170-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep_inc =</span> <span class="fu">round</span>(aug_inc <span class="sc">*</span> <span class="fl">1.2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">52</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb170-728"><a href="#cb170-728" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-729"><a href="#cb170-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-730"><a href="#cb170-730" aria-hidden="true" tabindex="-1"></a><span class="co"># add random September incidence</span></span>
<span id="cb170-731"><a href="#cb170-731" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-732"><a href="#cb170-732" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-733"><a href="#cb170-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep_inc =</span> <span class="fu">rbinom</span>(<span class="dv">52</span>, <span class="dv">1000</span>, <span class="fl">0.7</span>)</span>
<span id="cb170-734"><a href="#cb170-734" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-735"><a href="#cb170-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-736"><a href="#cb170-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-737"><a href="#cb170-737" aria-hidden="true" tabindex="-1"></a>If we wanted to update a column, we can do that by specifying the column on both sides of the equals sign.</span>
<span id="cb170-738"><a href="#cb170-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-741"><a href="#cb170-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-742"><a href="#cb170-742" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the August incidence to add random noise</span></span>
<span id="cb170-743"><a href="#cb170-743" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-744"><a href="#cb170-744" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-745"><a href="#cb170-745" aria-hidden="true" tabindex="-1"></a>    <span class="at">aug_inc =</span> aug_inc <span class="sc">+</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">52</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb170-746"><a href="#cb170-746" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-747"><a href="#cb170-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-748"><a href="#cb170-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-749"><a href="#cb170-749" aria-hidden="true" tabindex="-1"></a>One crucial thing to note is that <span class="in">`mutate()`</span> applies our function/operation to each row simultaneously, so the new column's value only depends on the *row's* original values (or the vector in the case of the second example that didn't use the values from the data).</span>
<span id="cb170-750"><a href="#cb170-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-751"><a href="#cb170-751" aria-hidden="true" tabindex="-1"></a><span class="fu">### `paste0()`</span></span>
<span id="cb170-752"><a href="#cb170-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-753"><a href="#cb170-753" aria-hidden="true" tabindex="-1"></a>The <span class="in">`paste0()`</span> function is useful for manipulating objects and coercing them into string, allowing us to do *string interpolation*.</span>
<span id="cb170-754"><a href="#cb170-754" aria-hidden="true" tabindex="-1"></a>It comes installed with base <span class="in">`R`</span>, so there's nothing to install, and because of the way <span class="in">`mutate()`</span> works, apply functions to each row simultaneously, we can modify whole columns at once, depending on the row's original values.</span>
<span id="cb170-755"><a href="#cb170-755" aria-hidden="true" tabindex="-1"></a>It works to *squish* all the values together, without any separators by default.</span>
<span id="cb170-756"><a href="#cb170-756" aria-hidden="true" tabindex="-1"></a>If you wanted spaces between your words, for example, you can use the <span class="in">`paste(..., sep = " ")`</span> function, which takes the <span class="in">`sep`</span> argument.</span>
<span id="cb170-757"><a href="#cb170-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-760"><a href="#cb170-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-761"><a href="#cb170-761" aria-hidden="true" tabindex="-1"></a>char_df <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb170-762"><a href="#cb170-762" aria-hidden="true" tabindex="-1"></a>    long_df,</span>
<span id="cb170-763"><a href="#cb170-763" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Notice that text is in commas, and object values being passed to paste0()</span></span>
<span id="cb170-764"><a href="#cb170-764" aria-hidden="true" tabindex="-1"></a>    <span class="co"># are unquoted.</span></span>
<span id="cb170-765"><a href="#cb170-765" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_id =</span> <span class="fu">paste0</span>(<span class="st">"state_"</span>, state_id)</span>
<span id="cb170-766"><a href="#cb170-766" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-767"><a href="#cb170-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-768"><a href="#cb170-768" aria-hidden="true" tabindex="-1"></a>char_df</span>
<span id="cb170-769"><a href="#cb170-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-770"><a href="#cb170-770" aria-hidden="true" tabindex="-1"></a><span class="fu">### `glue::glue()` {#sec-glue}</span></span>
<span id="cb170-771"><a href="#cb170-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-772"><a href="#cb170-772" aria-hidden="true" tabindex="-1"></a><span class="in">`glue()`</span> is a function that comes installed with <span class="in">`{tidyverse}`</span>, but is not loaded automatically, so you have to reference it explicitly by either using <span class="in">`library(glue)`</span> or the <span class="in">`::`</span> notation shown below.</span>
<span id="cb170-773"><a href="#cb170-773" aria-hidden="true" tabindex="-1"></a>It serves the same purpose as the base <span class="in">`paste0()`</span>, but in a slightly different syntax.</span>
<span id="cb170-774"><a href="#cb170-774" aria-hidden="true" tabindex="-1"></a>Instead of using a mix of quotations and unquoted object names, <span class="in">`glue()`</span> requires everything to be in quotation marks, with any value being passed to the *string interpolation* being *enclosed* in <span class="in">`{ }`</span>.</span>
<span id="cb170-775"><a href="#cb170-775" aria-hidden="true" tabindex="-1"></a>It is worth learning <span class="in">`glue()`</span> as it is used throughout the <span class="in">`{tidyverse}`</span> packages, such as in the <span class="in">`pivot_wider()`</span> function.</span>
<span id="cb170-776"><a href="#cb170-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-779"><a href="#cb170-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-780"><a href="#cb170-780" aria-hidden="true" tabindex="-1"></a>char_df <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb170-781"><a href="#cb170-781" aria-hidden="true" tabindex="-1"></a>    long_df,</span>
<span id="cb170-782"><a href="#cb170-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_id =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"state_{state_id}"</span>)</span>
<span id="cb170-783"><a href="#cb170-783" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-784"><a href="#cb170-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-785"><a href="#cb170-785" aria-hidden="true" tabindex="-1"></a>char_df</span>
<span id="cb170-786"><a href="#cb170-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-787"><a href="#cb170-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-788"><a href="#cb170-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### `str_replace_all()`</span></span>
<span id="cb170-789"><a href="#cb170-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-790"><a href="#cb170-790" aria-hidden="true" tabindex="-1"></a>If we want to replace characters throughout the whole of a string vector, we can do that with the <span class="in">`str_replace_all()`</span> function.</span>
<span id="cb170-791"><a href="#cb170-791" aria-hidden="true" tabindex="-1"></a>And because **dataframes** are made up of individual **vectors**, we can use this to modify vectors.</span>
<span id="cb170-792"><a href="#cb170-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-795"><a href="#cb170-795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-796"><a href="#cb170-796" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-797"><a href="#cb170-797" aria-hidden="true" tabindex="-1"></a>    char_df,</span>
<span id="cb170-798"><a href="#cb170-798" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pass in the vector (a column, here), the pattern to remove, and the replacement</span></span>
<span id="cb170-799"><a href="#cb170-799" aria-hidden="true" tabindex="-1"></a>    <span class="at">clean_state_id =</span> <span class="fu">str_replace_all</span>(state_id, <span class="st">"state_"</span>, <span class="st">""</span>)</span>
<span id="cb170-800"><a href="#cb170-800" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-801"><a href="#cb170-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-802"><a href="#cb170-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-803"><a href="#cb170-803" aria-hidden="true" tabindex="-1"></a><span class="fu">### `across()`</span></span>
<span id="cb170-804"><a href="#cb170-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-805"><a href="#cb170-805" aria-hidden="true" tabindex="-1"></a>Above, we were only **mutating** a single column at a time, which is what we often do.</span>
<span id="cb170-806"><a href="#cb170-806" aria-hidden="true" tabindex="-1"></a>But, sometimes we want to apply the exact same transformation to multiple columns.</span>
<span id="cb170-807"><a href="#cb170-807" aria-hidden="true" tabindex="-1"></a>For example, say we wanted to turn our monthly incidence data into the average weekly incidence.</span>
<span id="cb170-808"><a href="#cb170-808" aria-hidden="true" tabindex="-1"></a>We could write out each transformation by hand, but when there are more than two columns, this gets rather tedious and introduces the opportunity for mistakes when copying code (one of our motivations for using functions).</span>
<span id="cb170-809"><a href="#cb170-809" aria-hidden="true" tabindex="-1"></a>The <span class="in">`tidyselect::across()`</span> function allows us to specify the columns we want to apply the transformation, and the function (can be named or anonymous), and that's it.</span>
<span id="cb170-810"><a href="#cb170-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-811"><a href="#cb170-811" aria-hidden="true" tabindex="-1"></a>There are a couple of points to understand about the code below:</span>
<span id="cb170-812"><a href="#cb170-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-813"><a href="#cb170-813" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Note the <span class="in">`.`</span> preceding the <span class="in">`cols`</span>, <span class="in">`fns`</span>, and <span class="in">`x`</span></span>
<span id="cb170-814"><a href="#cb170-814" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each column is passed to the <span class="in">`.x`</span> value in the function argument</span>
<span id="cb170-815"><a href="#cb170-815" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`~`</span> is required to pass arguments into the function. In this case it is an anonymous function using the <span class="co">[</span><span class="ot">`map_*()` syntax</span><span class="co">](#sec-map-functions)</span>.</span>
<span id="cb170-816"><a href="#cb170-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-819"><a href="#cb170-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-820"><a href="#cb170-820" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-821"><a href="#cb170-821" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-822"><a href="#cb170-822" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb170-823"><a href="#cb170-823" aria-hidden="true" tabindex="-1"></a>        <span class="at">.cols =</span> <span class="fu">c</span>(july_inc, aug_inc),</span>
<span id="cb170-824"><a href="#cb170-824" aria-hidden="true" tabindex="-1"></a>        <span class="at">.fns =</span> <span class="sc">~</span>.x <span class="sc">*</span> <span class="dv">7</span> <span class="sc">/</span> <span class="dv">30</span></span>
<span id="cb170-825"><a href="#cb170-825" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb170-826"><a href="#cb170-826" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-827"><a href="#cb170-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-828"><a href="#cb170-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-829"><a href="#cb170-829" aria-hidden="true" tabindex="-1"></a><span class="fu">### `everything()`</span></span>
<span id="cb170-830"><a href="#cb170-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-831"><a href="#cb170-831" aria-hidden="true" tabindex="-1"></a>If we wanted to select every column in a dataframe, we would use the <span class="in">`everything()`</span> function.</span>
<span id="cb170-832"><a href="#cb170-832" aria-hidden="true" tabindex="-1"></a>This may not seem helpful initially, but there are occasions when it's very useful.</span>
<span id="cb170-833"><a href="#cb170-833" aria-hidden="true" tabindex="-1"></a>For instance, in the previous example we still specified the exact columns we wanted to transform.</span>
<span id="cb170-834"><a href="#cb170-834" aria-hidden="true" tabindex="-1"></a>However, if there were five times as many, we wouldn't want to do that.</span>
<span id="cb170-835"><a href="#cb170-835" aria-hidden="true" tabindex="-1"></a>Do note that if we replaced this with <span class="in">`everything()`</span>, we would also <span class="in">`mutate()`</span> our <span class="in">`state_id`</span> column, which we probably don't want to do, so we could combine it with the <span class="in">`-`</span> selection seen previously.</span>
<span id="cb170-836"><a href="#cb170-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-837"><a href="#cb170-837" aria-hidden="true" tabindex="-1"></a><span class="fu">### `contains()`</span></span>
<span id="cb170-838"><a href="#cb170-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-839"><a href="#cb170-839" aria-hidden="true" tabindex="-1"></a>Another very handy function is the <span class="in">`tidyselect::contains()`</span> function.</span>
<span id="cb170-840"><a href="#cb170-840" aria-hidden="true" tabindex="-1"></a>This allows us to specify a string that the column names must *contain* for them to be selected.</span>
<span id="cb170-841"><a href="#cb170-841" aria-hidden="true" tabindex="-1"></a>We could change the above example to look like this:</span>
<span id="cb170-842"><a href="#cb170-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-845"><a href="#cb170-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-846"><a href="#cb170-846" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-847"><a href="#cb170-847" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-848"><a href="#cb170-848" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb170-849"><a href="#cb170-849" aria-hidden="true" tabindex="-1"></a>        <span class="at">.cols =</span> <span class="fu">contains</span>(<span class="st">"_inc"</span>),</span>
<span id="cb170-850"><a href="#cb170-850" aria-hidden="true" tabindex="-1"></a>        <span class="at">.fns =</span> <span class="sc">~</span>.x <span class="sc">*</span> <span class="dv">7</span> <span class="sc">/</span> <span class="dv">30</span></span>
<span id="cb170-851"><a href="#cb170-851" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb170-852"><a href="#cb170-852" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-853"><a href="#cb170-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-854"><a href="#cb170-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-855"><a href="#cb170-855" aria-hidden="true" tabindex="-1"></a><span class="fu">### `rename_with()`</span></span>
<span id="cb170-856"><a href="#cb170-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-857"><a href="#cb170-857" aria-hidden="true" tabindex="-1"></a>If we wanted to rename columns of a **dataframe**, we can use the <span class="in">`rename()`</span> function.</span>
<span id="cb170-858"><a href="#cb170-858" aria-hidden="true" tabindex="-1"></a>However, like the previous <span class="in">`{tidyselect}`</span> examples, sometimes we want to apply the same renaming scheme (function) to the columns.</span>
<span id="cb170-859"><a href="#cb170-859" aria-hidden="true" tabindex="-1"></a><span class="in">`rename_with()`</span> allows us to pass a function to multiple columns at once, achieving what we want with minimal effort, and without needing to use <span class="in">`across()`</span>.</span>
<span id="cb170-860"><a href="#cb170-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-863"><a href="#cb170-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-864"><a href="#cb170-864" aria-hidden="true" tabindex="-1"></a><span class="fu">rename_with</span>(</span>
<span id="cb170-865"><a href="#cb170-865" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-866"><a href="#cb170-866" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">contains</span>(<span class="st">"_inc"</span>),</span>
<span id="cb170-867"><a href="#cb170-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fn =</span> <span class="sc">~</span><span class="fu">str_replace_all</span>(.x, <span class="st">"_inc"</span>, <span class="st">"_incidence"</span>)</span>
<span id="cb170-868"><a href="#cb170-868" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-869"><a href="#cb170-869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-870"><a href="#cb170-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-871"><a href="#cb170-871" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb170-872"><a href="#cb170-872" aria-hidden="true" tabindex="-1"></a>Hopefully you are noticing a pattern between the <span class="in">`{tidyselect}`</span>-type functions.</span>
<span id="cb170-873"><a href="#cb170-873" aria-hidden="true" tabindex="-1"></a>When you need to apply a function to multiple columns in a **dataframe**, you will select the columns with the <span class="in">`.cols`</span> argument, and pass the function to the <span class="in">`.fn(s)`</span> argument with the <span class="in">`~`</span> symbol indicating you are using the <span class="in">`.x`</span> to represent the column in the function (yes, there is a touch of ambiguity between <span class="in">`.fns`</span> and <span class="in">`.fn`</span>, but the general pattern holds).</span>
<span id="cb170-874"><a href="#cb170-874" aria-hidden="true" tabindex="-1"></a>This will be useful when we look at the <span class="in">`map_*()`</span> family of functions.</span>
<span id="cb170-875"><a href="#cb170-875" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-876"><a href="#cb170-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-877"><a href="#cb170-877" aria-hidden="true" tabindex="-1"></a><span class="fu">### `magrittr::%&gt;%`</span></span>
<span id="cb170-878"><a href="#cb170-878" aria-hidden="true" tabindex="-1"></a>The <span class="in">`%&gt;%`</span> operator is an interesting and very useful function that comes installed (and loaded) with the <span class="in">`{tidyverse}`</span> package (technically from the <span class="in">`{magrittr}`</span> package from within the <span class="in">`{tidyverse}`</span>).</span>
<span id="cb170-879"><a href="#cb170-879" aria-hidden="true" tabindex="-1"></a>It allows us to chain together operations without needing to create intermediate objects.</span>
<span id="cb170-880"><a href="#cb170-880" aria-hidden="true" tabindex="-1"></a>Say for example we have our wide incidence data and want to add data for September before turning it into a **long dataframe**, we could create and intermediate object before using the <span class="in">`pivot_longer()`</span> function from before, but we might not want to create another object that we don't really care about.</span>
<span id="cb170-881"><a href="#cb170-881" aria-hidden="true" tabindex="-1"></a>This is when we would want to use a pipe, as it takes the output of one operation and *pipes* it into the next one.</span>
<span id="cb170-882"><a href="#cb170-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-885"><a href="#cb170-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-886"><a href="#cb170-886" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb170-887"><a href="#cb170-887" aria-hidden="true" tabindex="-1"></a>    wide_df,</span>
<span id="cb170-888"><a href="#cb170-888" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep_inc =</span> <span class="fu">round</span>(aug_inc <span class="sc">*</span> <span class="fl">1.2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">52</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb170-889"><a href="#cb170-889" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb170-890"><a href="#cb170-890" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb170-891"><a href="#cb170-891" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">c</span>(july_inc, aug_inc, sep_inc),</span>
<span id="cb170-892"><a href="#cb170-892" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"month"</span>,</span>
<span id="cb170-893"><a href="#cb170-893" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"incidence"</span>,</span>
<span id="cb170-894"><a href="#cb170-894" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_pattern =</span> <span class="st">"(.*)_inc"</span>,</span>
<span id="cb170-895"><a href="#cb170-895" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> .</span>
<span id="cb170-896"><a href="#cb170-896" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb170-897"><a href="#cb170-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-898"><a href="#cb170-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-899"><a href="#cb170-899" aria-hidden="true" tabindex="-1"></a>By default, the previous object gets input into the first argument of the next function, but here we've shown that you can manipulate the position the object is *piped* into by specify the argument using the <span class="in">`.`</span> syntax.</span>
<span id="cb170-900"><a href="#cb170-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-901"><a href="#cb170-901" aria-hidden="true" tabindex="-1"></a><span class="fu">### `|&gt;`</span></span>
<span id="cb170-902"><a href="#cb170-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-903"><a href="#cb170-903" aria-hidden="true" tabindex="-1"></a>In <span class="in">`R`</span> version 4.1.0, the <span class="in">`|&gt;`</span> was added as the base pipe operator.</span>
<span id="cb170-904"><a href="#cb170-904" aria-hidden="true" tabindex="-1"></a>It works slightly differently to <span class="in">`%&gt;%`</span>, and frankly, is less powerful and less common (at the moment), so we won't use it in this workshop.</span>
<span id="cb170-905"><a href="#cb170-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-906"><a href="#cb170-906" aria-hidden="true" tabindex="-1"></a><span class="fu">### `group_by()`</span></span>
<span id="cb170-907"><a href="#cb170-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-908"><a href="#cb170-908" aria-hidden="true" tabindex="-1"></a>If we have groups in our **dataframe** and want to apply some function to each group's data, we can use the <span class="in">`group_by()`</span> function.</span>
<span id="cb170-909"><a href="#cb170-909" aria-hidden="true" tabindex="-1"></a>For example, if we wanted to calculate the mean and median incidence in our fake data from earlier, but group it by the month.</span>
<span id="cb170-910"><a href="#cb170-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-913"><a href="#cb170-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-914"><a href="#cb170-914" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(long_df, month) <span class="sc">%&gt;%</span></span>
<span id="cb170-915"><a href="#cb170-915" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(incidence), <span class="at">median =</span> <span class="fu">median</span>(incidence))</span>
<span id="cb170-916"><a href="#cb170-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-917"><a href="#cb170-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-918"><a href="#cb170-918" aria-hidden="true" tabindex="-1"></a><span class="fu">### `pivot_*()` {#sec-pivot-functions}</span></span>
<span id="cb170-919"><a href="#cb170-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-920"><a href="#cb170-920" aria-hidden="true" tabindex="-1"></a>We've <span class="co">[</span><span class="ot">already seen</span><span class="co">](#tidy-data)</span> the purpose of the <span class="in">`pivot_longer()`</span> function: taking wide data and reshaping it to be long.</span>
<span id="cb170-921"><a href="#cb170-921" aria-hidden="true" tabindex="-1"></a>There is an equivalent to go from long to wide: <span class="in">`pivot_wider()`</span>.</span>
<span id="cb170-922"><a href="#cb170-922" aria-hidden="true" tabindex="-1"></a>Occassionally this is useful (though it is less common than creating long data).</span>
<span id="cb170-923"><a href="#cb170-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-926"><a href="#cb170-926" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-927"><a href="#cb170-927" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(</span>
<span id="cb170-928"><a href="#cb170-928" aria-hidden="true" tabindex="-1"></a>    long_df,</span>
<span id="cb170-929"><a href="#cb170-929" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> month,</span>
<span id="cb170-930"><a href="#cb170-930" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> incidence,</span>
<span id="cb170-931"><a href="#cb170-931" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_glue =</span> <span class="st">"{month}_inc"</span></span>
<span id="cb170-932"><a href="#cb170-932" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-933"><a href="#cb170-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-934"><a href="#cb170-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-935"><a href="#cb170-935" aria-hidden="true" tabindex="-1"></a>Here, the <span class="in">`names_glue`</span> argument is making use of the <span class="in">`glue::glue()`</span> function (<span class="co">[</span><span class="ot">see above</span><span class="co">](#sec-glue)</span>) that is installed with <span class="in">`{tidyverse}`</span>, but not loaded automatically for use by the users.</span>
<span id="cb170-936"><a href="#cb170-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-937"><a href="#cb170-937" aria-hidden="true" tabindex="-1"></a><span class="fu">### `map_*()` {#sec-map-functions}</span></span>
<span id="cb170-938"><a href="#cb170-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-939"><a href="#cb170-939" aria-hidden="true" tabindex="-1"></a>The <span class="in">`map_*()`</span> functions come from the <span class="in">`{purrr}`</span> package (a core part of the <span class="in">`{tidyverse}`</span>), and are incredibly useful.</span>
<span id="cb170-940"><a href="#cb170-940" aria-hidden="true" tabindex="-1"></a>They are relatively complicated, so there isn't enough space to go into full detail, but here we'll just outline enough so you can read more and understand what's going on.</span>
<span id="cb170-941"><a href="#cb170-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-942"><a href="#cb170-942" aria-hidden="true" tabindex="-1"></a>We've <span class="co">[</span><span class="ot">already seen</span><span class="co">](#anonymous-functions)</span> we can apply functions to each element of a vector (**atomic** or **list** vectors).</span>
<span id="cb170-943"><a href="#cb170-943" aria-hidden="true" tabindex="-1"></a>The key points to note are the <span class="in">`.`</span> preceding the <span class="in">`x`</span> and <span class="in">`f`</span> arguments.</span>
<span id="cb170-944"><a href="#cb170-944" aria-hidden="true" tabindex="-1"></a>If we use <span class="in">`map()`</span> we get a **list** returned, `map_dbl()` a **double vector**, `map_char()` a **character vector**, `map_dfr()` a **dataframe** etc.</span>
<span id="cb170-945"><a href="#cb170-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-946"><a href="#cb170-946" aria-hidden="true" tabindex="-1"></a>In the example below, we'll walk through <span class="in">`map_dfr()`</span> as it's one of the more confusing variants due to the **return** requirements.</span>
<span id="cb170-947"><a href="#cb170-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-950"><a href="#cb170-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-951"><a href="#cb170-951" aria-hidden="true" tabindex="-1"></a>map_dfr_example <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb170-952"><a href="#cb170-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> my_dbl_vec,</span>
<span id="cb170-953"><a href="#cb170-953" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="cf">function</span>(.x) {</span>
<span id="cb170-954"><a href="#cb170-954" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note we don't use , at the end of each line - it's as if we were</span></span>
<span id="cb170-955"><a href="#cb170-955" aria-hidden="true" tabindex="-1"></a>        <span class="co"># running the code in the console</span></span>
<span id="cb170-956"><a href="#cb170-956" aria-hidden="true" tabindex="-1"></a>        times_ten <span class="ot">&lt;-</span> .x <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb170-957"><a href="#cb170-957" aria-hidden="true" tabindex="-1"></a>        divide_ten <span class="ot">&lt;-</span> .x <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb170-958"><a href="#cb170-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-959"><a href="#cb170-959" aria-hidden="true" tabindex="-1"></a>        <span class="co"># construct a tibble as normal (requires , between arguments)</span></span>
<span id="cb170-960"><a href="#cb170-960" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(</span>
<span id="cb170-961"><a href="#cb170-961" aria-hidden="true" tabindex="-1"></a>            <span class="at">original_val =</span> .x,</span>
<span id="cb170-962"><a href="#cb170-962" aria-hidden="true" tabindex="-1"></a>            <span class="at">times_ten =</span> times_ten,</span>
<span id="cb170-963"><a href="#cb170-963" aria-hidden="true" tabindex="-1"></a>            <span class="at">divide_ten =</span> divide_ten</span>
<span id="cb170-964"><a href="#cb170-964" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb170-965"><a href="#cb170-965" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-966"><a href="#cb170-966" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-967"><a href="#cb170-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-968"><a href="#cb170-968" aria-hidden="true" tabindex="-1"></a>map_dfr_example</span>
<span id="cb170-969"><a href="#cb170-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-970"><a href="#cb170-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-971"><a href="#cb170-971" aria-hidden="true" tabindex="-1"></a>What's happening under the hood is that <span class="in">`map_dfr()`</span> is applying the <span class="co">[</span><span class="ot">anonymous function</span><span class="co">](#anonymous-functions)</span> we defined to each element in our vector and returning a **list** of **dataframes** that contains one row and three columns, i.e. for the first element, we would get this:</span>
<span id="cb170-972"><a href="#cb170-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-975"><a href="#cb170-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-976"><a href="#cb170-976" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(map_dfr_example[<span class="dv">1</span>, ])</span>
<span id="cb170-977"><a href="#cb170-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-978"><a href="#cb170-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-979"><a href="#cb170-979" aria-hidden="true" tabindex="-1"></a>It then calls the <span class="in">`bind_rows()`</span> function to *squash* all of those **dataframes** together, one row stacked on top of the next, to create one large **dataframe**.</span>
<span id="cb170-980"><a href="#cb170-980" aria-hidden="true" tabindex="-1"></a>We could write the equivalent code like this:</span>
<span id="cb170-981"><a href="#cb170-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-984"><a href="#cb170-984" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-985"><a href="#cb170-985" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb170-986"><a href="#cb170-986" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(</span>
<span id="cb170-987"><a href="#cb170-987" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> my_dbl_vec,</span>
<span id="cb170-988"><a href="#cb170-988" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="cf">function</span>(.x) {</span>
<span id="cb170-989"><a href="#cb170-989" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note we don't use , at the end of each line - it's as if we were</span></span>
<span id="cb170-990"><a href="#cb170-990" aria-hidden="true" tabindex="-1"></a>        <span class="co"># running the code in the console</span></span>
<span id="cb170-991"><a href="#cb170-991" aria-hidden="true" tabindex="-1"></a>        times_ten <span class="ot">&lt;-</span> .x <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb170-992"><a href="#cb170-992" aria-hidden="true" tabindex="-1"></a>        divide_ten <span class="ot">&lt;-</span> .x <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb170-993"><a href="#cb170-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-994"><a href="#cb170-994" aria-hidden="true" tabindex="-1"></a>        <span class="co"># construct a tibble as normal (requires , between arguments)</span></span>
<span id="cb170-995"><a href="#cb170-995" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(</span>
<span id="cb170-996"><a href="#cb170-996" aria-hidden="true" tabindex="-1"></a>            <span class="at">original_val =</span> .x,</span>
<span id="cb170-997"><a href="#cb170-997" aria-hidden="true" tabindex="-1"></a>            <span class="at">times_ten =</span> times_ten,</span>
<span id="cb170-998"><a href="#cb170-998" aria-hidden="true" tabindex="-1"></a>            <span class="at">divide_ten =</span> divide_ten</span>
<span id="cb170-999"><a href="#cb170-999" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb170-1000"><a href="#cb170-1000" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-1001"><a href="#cb170-1001" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-1002"><a href="#cb170-1002" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-1003"><a href="#cb170-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1004"><a href="#cb170-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1005"><a href="#cb170-1005" aria-hidden="true" tabindex="-1"></a><span class="in">`map_dfc()`</span> does exactly the same thing, but calls <span class="in">`bind_cols()`</span> instead, to place the columns next to each other.</span>
<span id="cb170-1006"><a href="#cb170-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1007"><a href="#cb170-1007" aria-hidden="true" tabindex="-1"></a>There is one more important variant to go through: <span class="in">`pmap_*()`</span>.</span>
<span id="cb170-1008"><a href="#cb170-1008" aria-hidden="true" tabindex="-1"></a>If <span class="in">`map_*()`</span> takes one vector as an argument, <span class="in">`pmap_*()`</span> takes a **list** of arguments.</span>
<span id="cb170-1009"><a href="#cb170-1009" aria-hidden="true" tabindex="-1"></a>What this means is that we can iterate through the elements of as many arguments as we'd like, *in sequence*.</span>
<span id="cb170-1010"><a href="#cb170-1010" aria-hidden="true" tabindex="-1"></a>For example, let's multiply the elements of two **double** vectors together.</span>
<span id="cb170-1011"><a href="#cb170-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1014"><a href="#cb170-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1015"><a href="#cb170-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a second vector of numbers</span></span>
<span id="cb170-1016"><a href="#cb170-1016" aria-hidden="true" tabindex="-1"></a>my_second_dbl_vec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(my_dbl_vec), <span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb170-1017"><a href="#cb170-1017" aria-hidden="true" tabindex="-1"></a>my_second_dbl_vec</span>
<span id="cb170-1018"><a href="#cb170-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># Remind ourselves what our original vector looks like</span></span>
<span id="cb170-1019"><a href="#cb170-1019" aria-hidden="true" tabindex="-1"></a>my_dbl_vec</span>
<span id="cb170-1020"><a href="#cb170-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1021"><a href="#cb170-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1022"><a href="#cb170-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">pmap_dbl</span>(</span>
<span id="cb170-1023"><a href="#cb170-1023" aria-hidden="true" tabindex="-1"></a>    <span class="at">.l =</span> <span class="fu">list</span>(<span class="at">first_num =</span> my_dbl_vec, <span class="at">sec_num =</span> my_second_dbl_vec),</span>
<span id="cb170-1024"><a href="#cb170-1024" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="cf">function</span>(first_num, sec_num) {</span>
<span id="cb170-1025"><a href="#cb170-1025" aria-hidden="true" tabindex="-1"></a>        first_num <span class="sc">*</span> sec_num</span>
<span id="cb170-1026"><a href="#cb170-1026" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-1027"><a href="#cb170-1027" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-1028"><a href="#cb170-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1029"><a href="#cb170-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1030"><a href="#cb170-1030" aria-hidden="true" tabindex="-1"></a>There are a couple of important points to note here:</span>
<span id="cb170-1031"><a href="#cb170-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1032"><a href="#cb170-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All vectors need to be the same length</span>
<span id="cb170-1033"><a href="#cb170-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The function is applied to each element index of the input vectors, i.e., the first elements of the vectors are multiplied together, the second element of the vectors are multiplied together, and so on, until the last elements are reached.</span>
<span id="cb170-1034"><a href="#cb170-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We use <span class="in">`.l`</span> instead of <span class="in">`.x`</span> to denote we are passing a <span class="in">`list()`</span> of vectors.</span>
<span id="cb170-1035"><a href="#cb170-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our function specifies the names of the vectors in the <span class="in">`list()`</span>, which are then used within the function itself (similar to how we used <span class="in">`.x`</span> in our <span class="in">`map_*()`</span> functions)</span>
<span id="cb170-1036"><a href="#cb170-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1037"><a href="#cb170-1037" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse=true}</span>
<span id="cb170-1038"><a href="#cb170-1038" aria-hidden="true" tabindex="-1"></a>As before, this is an unnecessary approach as <span class="in">`R`</span> would vectorize the operation, but it is useful to demonstrate the principle.</span>
<span id="cb170-1039"><a href="#cb170-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1042"><a href="#cb170-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1043"><a href="#cb170-1043" aria-hidden="true" tabindex="-1"></a>my_dbl_vec <span class="sc">*</span> my_second_dbl_vec</span>
<span id="cb170-1044"><a href="#cb170-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1045"><a href="#cb170-1045" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-1046"><a href="#cb170-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1047"><a href="#cb170-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">### `nest()`</span></span>
<span id="cb170-1048"><a href="#cb170-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1049"><a href="#cb170-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">### `ggplot()`</span></span>
<span id="cb170-1050"><a href="#cb170-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `facet_wrap()`</span></span>
<span id="cb170-1051"><a href="#cb170-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1052"><a href="#cb170-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">### `%*%`</span></span>
<span id="cb170-1053"><a href="#cb170-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1054"><a href="#cb170-1054" aria-hidden="true" tabindex="-1"></a>This is the matrix multiplication operator.</span>
<span id="cb170-1055"><a href="#cb170-1055" aria-hidden="true" tabindex="-1"></a>It works exactly as you'd expect given matrix multiplication rules.</span>
<span id="cb170-1056"><a href="#cb170-1056" aria-hidden="true" tabindex="-1"></a>As such, you can use it on any combination of vectors and matrices.</span>
<span id="cb170-1057"><a href="#cb170-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1058"><a href="#cb170-1058" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb170-1059"><a href="#cb170-1059" aria-hidden="true" tabindex="-1"></a>As you can see below, <span class="in">`R`</span> treats vectors as dimensionless, and will try to convert it to either a *row* or *column* vector, depending on what makes sense for the matrix multiplication</span>
<span id="cb170-1060"><a href="#cb170-1060" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb170-1061"><a href="#cb170-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1064"><a href="#cb170-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1065"><a href="#cb170-1065" aria-hidden="true" tabindex="-1"></a>my_dbl_vec <span class="sc">%*%</span> my_second_dbl_vec</span>
<span id="cb170-1066"><a href="#cb170-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb170-1067"><a href="#cb170-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1070"><a href="#cb170-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb170-1071"><a href="#cb170-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb170-1072"><a href="#cb170-1072" aria-hidden="true" tabindex="-1"></a>my_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, <span class="at">nrow =</span> <span class="dv">10</span>)</span>
<span id="cb170-1073"><a href="#cb170-1073" aria-hidden="true" tabindex="-1"></a>my_matrix</span>
<span id="cb170-1074"><a href="#cb170-1074" aria-hidden="true" tabindex="-1"></a>my_dbl_vec</span>
<span id="cb170-1075"><a href="#cb170-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1076"><a href="#cb170-1076" aria-hidden="true" tabindex="-1"></a>my_dbl_vec <span class="sc">%*%</span> my_matrix</span>
<span id="cb170-1077"><a href="#cb170-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1078"><a href="#cb170-1078" aria-hidden="true" tabindex="-1"></a>my_matrix <span class="sc">%*%</span> my_dbl_vec</span>
<span id="cb170-1079"><a href="#cb170-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1080"><a href="#cb170-1080" aria-hidden="true" tabindex="-1"></a>my_matrix <span class="sc">%*%</span> <span class="fu">t</span>(my_dbl_vec)</span>
<span id="cb170-1081"><a href="#cb170-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-1082"><a href="#cb170-1082" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(my_matrix) <span class="sc">%*%</span> my_dbl_vec</span>
<span id="cb170-1083"><a href="#cb170-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>